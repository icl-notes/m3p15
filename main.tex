\def\module{M3P15 Algebraic Number Theory}
\def\lecturer{Dr Ana Caraiani}
\def\term{Spring 2019}
\def\cover{
$$
\begin{tikzpicture}[scale=0.7]
\draw [help lines] (-9, -9) grid (9, 9);
\draw [->, dashed] (0, -10) to (0, 10);
\draw [->, dashed] (-10, 0) to (10, 0);
\draw [domain=-9:-1] plot (\x, {3*sqrt(10)/\x});
\draw [domain=1:9] plot (\x, {3*sqrt(10)/\x});
\draw [domain=-9:-1] plot (\x, {-3*sqrt(10)/\x});
\draw [domain=1:9] plot (\x, {-3*sqrt(10)/\x});
\draw (-6, 7) node[below]{$ \lambda\rb{\Q\rb{\sqrt{10}}} $};
\draw (-6.5, 6) node[below]{$ = \sqrt{4 \cdot 10} / 2 $};
\draw (-7, 5) node[below]{$ = \sqrt{10} $};
\draw (0, {2*sqrt(3*sqrt(10))}) to ({-2*sqrt(3*sqrt(10))}, 0);
\draw (0, {2*sqrt(3*sqrt(10))}) to ({2*sqrt(3*sqrt(10))}, 0);
\draw (0, -{2*sqrt(3*sqrt(10))}) to ({-2*sqrt(3*sqrt(10))}, 0);
\draw (0, -{2*sqrt(3*sqrt(10))}) to ({2*sqrt(3*sqrt(10))}, 0);
\draw [domain=-9:-3.7, dotted, thick] plot (\x, {\x + 4*sqrt(10)});
\draw [domain=-9:2.7, dotted, thick] plot (\x, {\x + 2*sqrt(10)});
\draw [domain=-9:9, dotted, thick] plot (\x, \x);
\draw [domain=-2.7:9, dotted, thick] plot (\x, {\x - 2*sqrt(10)});
\draw [domain=3.7:9, dotted, thick] plot (\x, {\x - 4*sqrt(10)});
\draw [domain=-9:-5.3, dotted, thick] plot (\x, {(2 + sqrt(10))/(2 - sqrt(10))*(\x + 6) - 6});
\draw [domain=-5.7:-1.7, dotted, thick] plot (\x, {(2 + sqrt(10))/(2 - sqrt(10))*(\x + 3) - 3});
\draw [domain=-2:2, dotted, thick] plot (\x, {(2 + sqrt(10))/(2 - sqrt(10))*\x});
\draw [domain=1.7:5.7, dotted, thick] plot (\x, {(2 + sqrt(10))/(2 - sqrt(10))*(\x - 3) + 3});
\draw [domain=5.3:9, dotted, thick] plot (\x, {(2 + sqrt(10))/(2 - sqrt(10))*(\x - 6) + 6});
\draw [fill=black] (-3, -3) circle (0.1) node[above right]{$ \alpha \in \sb{\ab{3, 2 + \sqrt{10}}} $};
\draw [->, thick] (0, 0) to (3, 3);
\draw (2, 1) node[above]{$ 3 $};
\draw [->, thick] (0, 0) to ({2 - sqrt(10)}, {2 + sqrt(10)});
\draw (-2, 2) node[above]{$ 2 + \sqrt{10} $};
\draw (1, 3) node[above]{$ \ab{3, 2 + \sqrt{10}} $};
\draw (6, -5) node{$ Cl\rb{\Q\rb{\sqrt{10}}} $};
\draw (6, -6) node{$ \cong \ab{\ab{3, 2 + \sqrt{10}}} $};
\draw (5, -7) node{$ \cong \Z / 2\Z $};
\end{tikzpicture}
$$
}
\def\syllabus{Rings. Unique factorisation domains. Principal ideal domains. Euclidean domains. Gaussian integers. Eisenstein integers. Number fields. Structure theorem for finitely generated abelian groups. Integral closure. Norms. Traces. Discriminants. Ring of integers. Dedekind domains. Unique factorisation of Dedekind domains. Splitting of prime ideals in quadratic fields. Class groups. Finiteness of class groups. Groups of units.}

\def\thm{subsection}

\input{header}

\begin{document}

\input{front}

\section{Motivation and overview}

\lecture{1}{Friday}{11/01/19}

The goal of this course will be to introduce algebraic number theory, specifically the arithmetic of finite extensions of $ \Q $, with an emphasis on quadratic extensions as a rich source of examples. We will start with some motivation and then review the necessary background from ring theory. We will then discuss unique factorisation domains, principal ideal domains and Euclidean domains. These tools will be enough to study Gaussian integers and Eisenstein integers in-depth. To understand more general number fields, we will need some more commutative algebra. We will discuss the structure theorem for finitely generated abelian groups and the notion of integral closure. We will also introduce norms, traces, and discriminants. We will show that rings of integers in number fields are Dedekind domains and we will state and prove unique factorisation for Dedekind domains. We will then study the splitting of prime ideals in quadratic fields. We will define the class group and prove that it is always finite. We will end with a discussion of the groups of units. For quadratic fields, a good reference with many examples is $ 2 $. Another reference we will use is $ 1 $.
\begin{enumerate}
\item P Samuel, Algebraic theory of numbers, 1970
\item M Trifkovic, Algebraic theory of quadratic numbers, 2013
\end{enumerate}
Algebraic number theory developed from
\begin{itemize}
\item trying to generalise known properties of integers, such as unique factorisation, to finite extensions of $ \Q $,
\item trying to solve Diophantine equations in a systematic way. For example, Fermat's equation
$$ x^n + y^n = z^n, \qquad n \ge 2, \qquad x, y, z \in \Z. $$
\end{itemize}
Let $ n \in \Z_{\ge 0} $. A question is when can we write $ n $ as
$$ n = a^2 + b^2, \qquad a, b \in \Z? $$
Some observations.
\begin{itemize}
\item If $ n = a_1^2 + b_1^2 $, $ m = a_2^2 + b_2^2 $,
$$ m \cdot n = \rb{a_1a_2 + b_1b_2}^2 + \rb{a_1b_2 - a_2b_1}^2. $$
\item Every $ n \ge 0 $ can be written as a product
$$ n = p_1^{k_1} \dots p_r^{k_r}, \qquad k_i \in \Z_{\ge 1}, $$
where $ p_i $ are prime numbers. Irreducibles are such that only divisors are $ 1 $ and $ p_i $. Primes are such that $ p_i \mid mn $ gives $ p_i \mid m $ or $ p_i \mid n $. Irreducibles and primes are equivalent in $ \Z $.
\item Only care about $ p_i $ with odd exponent.
\end{itemize}
When can we write
$$ p = a^2 + b^2, \qquad a, b \in \Z, $$
where $ p $ is prime? An observation is that
$$ p = 2, 5, 13, 17, 29, 37, \dots $$
is ok, and
$$ p \ne 3, 7, 11, 19, 23, \dots $$
is not ok. A conjecture is if $ p \equiv 3 \mod 4 $, then $ p \ne a^2 + b^2 $, otherwise this is ok.

\pagebreak

\begin{theorem}
If $ p \equiv 3 \mod 4 $ then $ p \ne a^2 + b^2 $.
\end{theorem}

\begin{proof}
$ a^2 + b^2 \equiv 0 \mod p $ and $ a, b \not\equiv 0 \mod p $ if and only if
$$ \rb{\dfrac{a}{b}}^2 \equiv -1 \mod p, $$
if and only if $ \jacobi{-1}{p} = 1 $, so $ p \equiv 3 \mod 4 $.
\end{proof}

\begin{remark*}
Proof tells us that $ n \ne a^2 + b^2 $ whenever $ n $ has a prime factor $ p_i \equiv 3 \mod 4 $ with odd exponent $ k_i $ for $ i = 1, \dots, r $. If every $ p \equiv 1 \mod 4 $ is of the form $ p = a^2 + b^2 $, then we understand the general case,
$$ n = a^2 + b^2 \qquad \iff \qquad \forall p_i \mid n, \ p_i \equiv 3 \mod 4, \ k_i \in 2\Z. $$
\end{remark*}

\begin{theorem}
If $ p \equiv 1 \mod 4 $ then
$$ p = a^2 + b^2, \qquad a, b \in \Z. $$
\end{theorem}

Factorisation in $ \Z\sb{i} $ for $ i^2 = 1 $ is $ p = a^2 + b^2 = \rb{a + bi}\rb{a - bi} $ for $ a, b \in \Z $.
$$ \Z\sb{i} = \Z \oplus \Z i = \cb{a + bi \mid a, b \in \Z} $$
is the subring of \textbf{Gaussian integers} in $ \Q\rb{i} / \Q $, an extension $ \Q\sb{x} / \rb{x^2 + 1} $ of $ \Q $ of degree two, a quadratic field. We will understand prime factorisation in $ \Z\sb{i} $, and in more general finite extensions of $ \Q $.

\begin{theorem}[Unique factorisation in $ \Z $]
\label{thm:uniquefactorisationinz}
Any $ n \in \Z \setminus \cb{0, \pm 1} $ can be written uniquely as a product of primes, up to permuting the prime factors or changing their signs.
\end{theorem}

\begin{proposition}[Division algorithm]
Given $ a, b \in \Z $, $ b \ne 0 $, there exist $ q, r \in \Z $ such that $ a = qb + r $ such that $ 0 \le r < \abs{b} $.
\end{proposition}

\begin{proposition}[Euclid's algorithm]
Let $ a, b \in \Z $, $ ab \ne 0 $. There exist a greatest common divisor $ \gcd\rb{a, b} \mid a $ and $ \gcd\rb{a, b} \mid b $, and $ r, s \in \Z $ such that $ ar + bs = \gcd\rb{a, b} $.
\end{proposition}

\begin{proof}
Consider $ I = \cb{ma + nb \mid m, n \in \Z} $. $ \gcd\rb{a, b} $ will be the smallest positive element of $ I $.
\end{proof}

Let $ I \subseteq \Z $ be the ideal of $ \Z $ generated by $ a, b $. Proof of Euclid's algorithm shows $ I $ is generated by $ \gcd\rb{a, b} $. In fact, every ideal of $ \Z $ is generated by one element, that is it is \textbf{principal}.

\begin{proposition}[Euclid's lemma]
If $ p \in \Z $ is prime, then
$$ p \mid ab, \qquad a, b \in \Z \qquad \implies \qquad p \mid a \ \text{or} \ p \mid b. $$
\end{proposition}

\begin{proof}[Proof of Theorem \ref{thm:uniquefactorisationinz}]
\hfill
\begin{itemize}
\item All $ n \in \Z $ has a prime divisor by taking $ p \in \Z_{\ge 2} $, the smallest divisor of $ n $.
\item Prime factorisation exists. Let $ n $ be the smallest integer which does not have one.
\item Uniqueness. $ n = p_2 \dots p_n = q_2 \dots q_? $ Euclid's lemma gives $ p_1 \mid q_1 $, up to reordering, so $ p_1 = \pm q_1 $, and continue.
\end{itemize}
\end{proof}

\pagebreak

\section{Rings}

\lecture{2}{Monday}{14/01/19}

\subsection{Commutative rings}

\begin{definition}
A \textbf{ring} is commutative and with unity. A \textbf{unit} in a ring $ R $ is an element $ a \in R $ such that there exists $ b \in R $ with $ a \cdot b = 1 $.
\begin{itemize}
\item The set of units forms a group under multiplication, denoted by $ R^\times $.
\item If $ b \in R $ exists such that $ ab = 1 $ then $ b $ is unique.
\end{itemize}
If $ R \setminus \cb{0} = R^\times $, then $ R $ is a \textbf{field}.
\end{definition}

\begin{example*}
\hfill
\begin{itemize}
\item $ \Z^\times = \cb{\pm 1} $.
\item $ \Q^\times = \Q \setminus \cb{0} $.
\item $ \Z\sb{\sqrt{2}}^\times \supseteq \cb{\pm 1, \epsilon^n} $, where $ \epsilon = 1 + \sqrt{2} $.
$$ \Z\sb{\sqrt{2}} = \cb{a + b\sqrt{2} \mid a, b \in \Z}. $$
$ \rb{1 + \sqrt{2}}\rb{-1 + \sqrt{2}} = 2 - 1 = 1 $. $ \epsilon^n = \epsilon^m $ for $ n, m \in \Z $ and $ n \ge m $ if and only if $ \epsilon^{n - m} = 1 $.
\end{itemize}
\end{example*}

\begin{definition}
Let $ R $ be a ring. An \textbf{ideal} $ I \subseteq R $ is an additive subgroup, so $ x, y \in I $ gives $ x + y \in I $, which absorbs multiplication. If $ x \in I $ and $ a \in R $ then $ ax \in I $.
\end{definition}

\begin{fact*}
If $ \phi : R \to S $ a ring homomorphism then $ Ker\rb{\phi} \subseteq R $ is an ideal. Conversely, if $ I \subseteq R $ is an ideal, can define
$$ \dfrac{R}{I} = \dfrac{R}{\sim} $$
as the set of equivalence classes modulo $ I $, that is $ a + I $ for $ a \in R $, via $ a \sim b $ for $ a, b \in R $ if $ a - b \in I $.
\end{fact*}

\begin{proposition}
$ R / I $ has ring structure induced by
\begin{align*}
\rb{a + I} + \rb{b + I} & = \rb{a + b} + I, \\
\rb{a + I} \cdot \rb{b + I} & = \rb{a \cdot b} + I,
\end{align*}
and a canonical surjective ring homomorphism
$$ \function{R}{\dfrac{R}{I}}{a}{a + I}. $$
\end{proposition}

Check that $ a - a' \in I $ and $ b - b' \in I $ gives
$$ \rb{a + b} - \rb{a' + b'} = \rb{a - a'} + \rb{b - b'} \in I, $$
$$ ab - a'b' = a\rb{b - b'} + b'\rb{a - a'} \in I. $$

\begin{theorem}[First isomorphism theorem for rings]
\label{thm:firstisomorphism}
Let $ \phi : R \to S $ be a ring homomorphism. Then we have a canonical ring isomorphism
$$ \function{\dfrac{R}{Ker\rb{\phi}}}{\phi\rb{R} \subset S}{r + Ker\rb{\phi}}{\phi\rb{r}}, $$
for $ r \in R $.
\end{theorem}

\pagebreak

\begin{example*}
Let $ R = \Z\sb{\sqrt{5}} = \cb{a + b\sqrt{5} \mid a, b \in \Z} $.
\begin{itemize}
\item Let $ I $ be the ideal $ 11\Z \oplus \rb{4 - \sqrt{5}}\Z $. A question is what is $ R / I $? Claim that
$$ \dfrac{R}{I} \cong \dfrac{\Z}{11\Z} = \F_{11}, $$
the finite field with $ 11 $ elements. Write down $ \phi : R \twoheadrightarrow \Z / 11\Z $ such that $ Ker\rb{\phi} = I $, then result follows from Theorem \ref{thm:firstisomorphism}. Such a $ \phi $ would have to satisfy
$$ \phi\rb{4 - \sqrt{5}} = 0, \qquad \phi\rb{11} = 0. $$
$ \phi\rb{\sqrt{5}} = \phi\rb{4} = 4 \mod 11 $.
$$ \function[\phi]{\Z \oplus \Z\sb{\sqrt{5}}}{\dfrac{\Z}{11\Z}}{\sqrt{5}}{4}. $$
Still have to check that
$$ 16 = \phi\rb{5}^2 = \phi\rb{\sqrt{5}^2} = \phi\rb{5} = 5 \mod 11. $$
Ok because $ 16 \equiv 5 \mod 11 $.
\item What can we say about $ R / J $, where
$$ J = \ab{9, 4 - \sqrt{5}} = 9R + \rb{4 - \sqrt{5}}R $$
is generated over $ R $? $ R / J $ is trivial and $ \ab{9, 4 - \sqrt{5}} = R $.
\end{itemize}
\end{example*}

\begin{definition}
\hfill
\begin{itemize}
\item If $ I, J $ are ideals in a ring $ R $, we say that $ I $ \textbf{divides} $ J $ if $ J \subseteq I $.
\item We can form ideals
\begin{align*}
I \cap J & = \cb{r \mid r \in I, \ r \in J}, \\
I + J & = \cb{r + s \mid r \in I, \ s \in J}, \\
I \cdot J & = \cb{\sum_{i = 1}^n r_is_i \ \Bigg| \ r_i \in I, \ s_i \in J, \ i = 1, \dots, n}.
\end{align*}
\item $ I, J $ are said to be \textbf{relatively prime} if $ I + J = R $.
\end{itemize}
\end{definition}

\begin{theorem}[Chinese remainder theorem]
\label{thm:chineseremainder}
Let $ I, J $ be two relatively prime ideals of $ R $. Then
$$ \dfrac{R}{IJ} \cong \dfrac{R}{I} \times \dfrac{R}{J}. $$
\end{theorem}

\begin{remark*}
If $ R = \Z $, all ideals are principal and Theorem \ref{thm:chineseremainder} specialises to usual Chinese remainder theorem.
\end{remark*}

\begin{proof}
Find surjective ring homomorphism
$$ \function{R}{\dfrac{R}{I} \times \dfrac{R}{J}}{r}{\rb{r \mod I, r \mod J}}, $$
with kernel $ I \cdot J $.
\end{proof}

\begin{definition}
A ring $ R $ is \textbf{Noetherian} if it satisfies the \textbf{ascending chain condition} on ideals, that is any infinite sequence of ideals
$$ I_1 \subseteq I_2 \subseteq \dots $$
stabilises.
\end{definition}

\begin{example*}
$ \Z $ and $ \Z\sb{x} $ are Noetherian. $ \Z\sb{x_1, x_2, \dots} $ is not Noetherian.
\end{example*}

\pagebreak

\subsection{Integral domains}

\lecture{3}{Tuesday}{15/01/19}

\begin{definition}
A ring $ R $ is an \textbf{integral domain (ID)} if $ ab = 0 $ for $ a, b \in R $ gives $ a = 0 $ or $ b = 0 $.
\end{definition}

\begin{example*}
\hfill
\begin{itemize}
\item $ \Z $ and $ \Z\sb{\sqrt{5}} $ are IDs.
\item $ \Z\sb{\sqrt{5}} / \ab{4 - \sqrt{5}} = \Z / 11\Z = \F_{11} $, since $ I = 11\Z \oplus \rb{4 - \sqrt{5}}\Z = \rb{4 - \sqrt{5}} \cdot \Z\sb{\sqrt{5}} $, because $ 11 = \rb{4 - \sqrt{5}}\rb{4 + \sqrt{5}} = 16 - 5 $. Thus
$$ \dfrac{\Z\sb{\sqrt{5}}}{\ab{11}} \cong \dfrac{\Z\sb{\sqrt{5}}}{\ab{4 - \sqrt{5}}} \times \dfrac{\Z\sb{\sqrt{5}}}{\ab{4 - \sqrt{5}}} = \F_{11} \times \F_{11}, $$
which is no longer an ID.
\end{itemize}
\end{example*}

\begin{remark*}
An ideal $ \pp \subsetneq R $ is \textbf{prime} if $ ab \in \pp $ gives $ a \in \pp $ or $ b \in \pp $. $ \rb{a + \pp}\rb{b + \pp} = 0 $ in $ R / \pp $ gives $ a + \pp = 0 $, that is $ a \in \pp $, or $ b + \pp = 0 $, that is $ b \in \pp $. This is equivalent to asking that $ R / \pp $ is an ID.
\end{remark*}

IDs are well-suited to studying divisibility. $ a \mid b $ in $ R $ if there exists $ c $ such that $ ac = b $.

\begin{lemma}
Let $ R $ be an ID. If $ a \mid b $ and $ b \mid a $, then there exist $ c, d \in R^\times $ such that $ ac = b $ and $ bd = a $.
\end{lemma}

\begin{proof}
$ a \mid b $ gives there exists $ c $ such that $ ac = b $ and $ b \mid a $ gives there exists $ d $ such that $ bd = a $ for $ c, d \in R $. $ acd = bd = a $ if and only if $ a\rb{cd - 1} = 0 $. $ R $ is an ID gives $ a = 0 $ or $ cd = 1 $. If $ a = 0 $, then $ b = 0 $, so $ c = d = 1 $.
\end{proof}

\begin{definition}
Let $ R $ be an ID.
\begin{itemize}
\item We say $ a \in R $ is \textbf{irreducible} if
\begin{itemize}
\item $ a $ is not a unit, and
\item $ a = bc $ for $ b, c \in R $ then either $ b $ or $ c $ is in $ R^\times $.
\end{itemize}
\item We say $ a \in R $ is \textbf{prime} if
\begin{itemize}
\item $ a $ is not a unit, and
\item $ a \mid bc $ gives $ a \mid b $ or $ a \mid c $.
\end{itemize}
\end{itemize}
\end{definition}

$ \ab{0} $ is prime if and only if $ R $ is an ID.

\begin{remark*}
Over $ \Z $, these two notions are equivalent, but not in general. If $ R $ is an ID and $ a \in R \setminus \cb{0} $ is prime, then $ a $ is irreducible.
\end{remark*}

\begin{proof}
Let $ b, c \in R $ be such that $ a = bc $, so $ b \mid a $ and $ c \mid a $. Because $ a $ is prime, $ a = bc $ gives $ a \mid b $ or $ a \mid c $. Say $ a \mid b $ happens. There exists $ d \in R^\times $ such that $ a = bd $. $ a = bc $ gives $ b\rb{d - c} = 0 $. $ b \ne 0 $, because $ a \ne 0 $, so $ d = c $, that is $ c $ is a unit.
\end{proof}

\begin{remark*}
If $ a \in R \setminus \cb{0} $ is irreducible, $ a $ does not have to be prime.
\end{remark*}

\begin{example*}
$ \Z\sb{\sqrt{-5}} = \cb{a + b\sqrt{-5} \mid a, b \in \Z} $ is the ring of integers of $ \Q\rb{\sqrt{-5}} $, an extension of $ \Q $ of degree two, a subring of $ \C $. $ 6 = 2 \cdot 3 = \rb{1 + \sqrt{-5}} \cdot \rb{1 - \sqrt{-5}} $. Claim that these are two factorisations of $ 6 $ into irreducible elements.
\begin{itemize}
\item $ 2 $ is irreducible. Why? Assume $ 2 = \alpha\beta $ for $ \alpha, \beta \in \Z\sb{\sqrt{-5}} $. Goal is that $ \alpha $ or $ \beta $ is a unit. We will use
$$ \function[N]{\Z\sb{\sqrt{-5}}}{\Z_{\ge 0}}{a + \sqrt{-5}b}{\rb{a + \sqrt{-5}b}\rb{a - \sqrt{-5}b} = a^2 + 5b^2}, $$
which is multiplicative. $ N\rb{2} = 4 = N\rb{\alpha}N\rb{\beta} $. If $ N\rb{\alpha} = 1 $, then $ \alpha $ is a unit. $ N\rb{\alpha} = N\rb{\beta} = 2 $ gives $ a^2 + 5b^2 = 2 $, which has no solutions, a contradiction.
\item $ 2 $ and $ 1 + \sqrt{-5} $ do not differ by units, since $ N\rb{2} = 4 $ and $ N\rb{1 + \sqrt{-5}} = 6 $.
\end{itemize}
Upshot is that $ 2 $ is irreducible in $ \Z\sb{\sqrt{-5}} $ but not prime.
\end{example*}

\pagebreak

\subsection{Unique factorisation domains}

Let $ R $ be an ID. We define an equivalence relation $ \sim $ on $ R $ by $ a \sim b $ if $ a \mid b $ and $ b \mid a $, or there exist $ c, d \in R^\times $ such that $ a = bc $ and $ b = da $.

\begin{definition}
An ID $ R $ has \textbf{unique factorisation} if for all $ a \in R \setminus \cb{0} $ there is a factorisation $ a = u \cdot p_1 \cdot \dots \cdot p_r $, where $ u \in R^\times $ and the $ p_i $ are irreducible. This is unique in the sense that, if there exists another factorisation $ v \cdot q_1 \cdot \dots \cdot q_s $, where $ v \in R^\times $ and the $ q_i $ are irreducible, then $ r = s $, and up to reordering $ p_i \sim q_i $, for $ i = 1, \dots, r = s $. An ID with this property is called an \textbf{unique factorisation domain (UFD)},
\end{definition}

\begin{example*}
$ \Z $, but not $ \Z\sb{\sqrt{-5}} $.
\end{example*}

\begin{lemma}
If $ R $ is a UFD, then $ p \in R \setminus \cb{0} $ is irreducible gives $ p $ is prime.
\end{lemma}

\begin{proof}
Exercise.
\end{proof}

\begin{theorem}
\label{thm:ufd}
Let $ R $ be an ID. The following conditions are equivalent.
\begin{itemize}
\item $ R $ is a UFD.
\item $ R $ satisfies ascending chain condition for principal ideals, that is every infinite sequence
$$ \ab{a_1} \subseteq \ab{a_2} \subseteq \dots $$
stabilises after finitely many steps, and every irreducible in $ R $ is prime.
\end{itemize}
\end{theorem}

If $ R $ is a UFD, can define $ d\rb{a} \in \Z_{\ge 0} $ as the number of irreducible factorisations of $ a $. $ d\rb{a} = 0 $ if and only if $ a \in R^\times $ is a unit.

\begin{lemma}
Let $ R $ be a UFD and $ a \mid b $ for $ a, b \in R $. Then
\begin{itemize}
\item $ d\rb{a} \le d\rb{b} $, and
\item $ b \mid a $ if and only if $ d\rb{a} = d\rb{b} $.
\end{itemize}
\end{lemma}

\lecture{4}{Friday}{18/01/19}

\begin{proof}
Let $ a = u \cdot p_1 \cdot \dots \cdot p_{d\rb{a}} $ and $ b = v \cdot q_1 \cdot \dots \cdot q_{d\rb{b}} $. $ a \mid b $ gives $ b = a \cdot c $ for $ c \in R \setminus \cb{0} $. Let $ c = w \cdot r_1 \cdot \dots \cdot r_{d\rb{c}} $.
$$ v \cdot q_1 \cdot \dots \cdot q_{d\rb{b}} = u \cdot w \cdot p_1 \cdot \dots \cdot p_{d\rb{a}} \cdot r_1 \cdot \dots \cdot r_{d\rb{c}}. $$
Uniqueness of factorisation gives $ d\rb{b} = d\rb{a} + d\rb{c} $, so $ d\rb{b} \ge d\rb{a} $. Equality if and only if $ d\rb{c} = 0 $ if and only if $ c $ is a unit, if and only if $ b \mid a $.
\end{proof}

\begin{proof}[Proof of Theorem \ref{thm:ufd}]
\hfill
\begin{itemize}
\item[$ \implies $] Assume $ R $ is a UFD. Irreducibles are prime. Let
$$ \ab{a_1} \subseteq \ab{a_2} \subseteq \dots \qquad \implies \qquad \dots \mid a_2 \mid a_1 \qquad \implies \qquad d\rb{a_1} \ge \dots \ge 0. $$
This sequence stabilises after finitely many steps. There exists $ n $ such that
$$ d\rb{a_n} = d\rb{a_{n + 1}} = \dots \qquad \implies \qquad a_n \sim a_{n + 1} \sim \dots \qquad \implies \qquad \ab{a_n} = \ab{a_{n + 1}} = \dots. $$
\item[$ \impliedby $] For all $ a \in R \setminus \cb{0} $, claim that $ a $ has a factorisation into irreducibles. If $ a_1 = a $, irreducible. Otherwise $ a = b \cdot c $ for $ b, c \in R \setminus \cb{0} $ not units. If both irreducible, done. If not, say $ b $ not irreducible, $ a_2 = b $. $ a = bc $ for $ c $ not a unit gives $ \ab{a} \subsetneq \ab{b} $. Redoing the process here,
$$ \ab{a_1} \subsetneq \ab{a_2} \subsetneq \dots. $$
By ascending chain condition, this process terminates, getting a contradiction, so $ a $ has factorisation into irreducibles. The factorisation of $ a $ is unique, up to units and reordering. Let
$$ a = u \cdot p_1 \cdot \dots \cdot p_r = v \cdot q_1 \cdot \dots \cdot q_s. $$
$ p_1 $ irreducible gives $ p_1 $ is prime, so $ p_1 \mid q_i $ for some $ i $, where $ q_i $ is irreducible, so $ p_1 \sim q_i $. Cancel out $ p_1, q_i $ and repeat.
\end{itemize}
\end{proof}

\begin{remark*}
$ \Z\sb{\sqrt{-5}} $ is not a UFD because $ 2 $ is irreducible but not prime.
\end{remark*}

\pagebreak

\subsection{Principal ideal domains}

\begin{definition}
An ID $ R $ is a \textbf{principal ideal domain (PID)} if every ideal of $ R $ is principal.
\end{definition}

\begin{example*}
\hfill
\begin{itemize}
\item Fields.
\item $ \Z $ follows from Euclid's algorithm.
\end{itemize}
\end{example*}

\begin{theorem}
\label{thm:pid}
A PID $ R $ is a UFD.
\end{theorem}

\begin{proof}
Check two characterising properties.
\begin{itemize}
\item Ascending chain condition. Let
$$ \ab{a_1} \subseteq \ab{a_2} \subseteq \dots. $$
Consider
$$ I = \bigcup_{n = 1}^\infty \ab{a_n}. $$
Claim that $ I $ is an ideal of $ R $. Say $ x \in I $ and $ r \in R $. Want $ rx \in I $. There exists $ n \in \Z_{\ge 1} $ such that $ x \in \ab{a_n} $, so $ rx \in \ab{a_n} $ and $ rx \in I $. Say $ x, y \in I $. Then $ x \in \ab{a_n} $ for $ n \in \Z_{\ge 1} $ and $ y \in \ab{a_m} $ for $ m \in \Z_{\ge 1} $. If $ m \ge n $ then $ x \in \ab{a_m} $, so $ x + y \in \ab{a_m} $ gives $ x + y \in I $. Otherwise $ y \in \ab{a_n} $, so $ x + y \in \ab{a_n} $ gives $ x + y \in I $. Hence $ I \subseteq R $ is an ideal, so $ I $ is principal, that is there exists $ a \in R $ such that $ I = \ab{a} $. There exists $ n \in \Z_{\ge 1} $ such that $ a \in \ab{a_n} $. Have inclusions
$$ \ab{a} \subseteq \ab{a_n} \subseteq \ab{a_m} \subseteq \ab{a}. $$
All inclusions are equalities, so $ \ab{a_m} = \ab{a_n} $ for all $ m \ge n $.
\item Exercise: irreducibles are prime.
\end{itemize}
\end{proof}

\begin{remark*}
\hfill
\begin{itemize}
\item $ \Z\sb{\sqrt{-5}} $ is not a PID. Follows from Theorem \ref{thm:pid} and failure of unique factorisation. $ \ab{2, 1 + \sqrt{-5}} $ is not a principal ideal. (Exercise: check this)
\item A UFD that is not a PID. $ \Q\sb{x, y} $ is a UFD but $ \ab{x, y} $ is not principal. $ \Z\sb{x} $ is a UFD but $ \ab{2, x} $ is not principal.
\end{itemize}
\end{remark*}

\pagebreak

\subsection{Euclidean domains}

\begin{definition}
\hfill
\begin{itemize}
\item A \textbf{Euclidean norm} on an ID $ R $ is a function $ \phi : R \setminus \cb{0} \to \Z_{\ge 1} $ such that for all $ a, b \in R \setminus \cb{0} $ there exist $ q, r \in R $ such that $ a = qb + r $ and
\begin{itemize}
\item either $ r = 0 $,
\item or $ \phi\rb{r} < \phi\rb{b} $.
\end{itemize}
\item An ID that admits a Euclidean norm is called a \textbf{Euclidean domain}.
\end{itemize}
\end{definition}

Sometimes, add condition
\begin{equation}
\label{eq:1}
\phi\rb{ab} \ge \phi\rb{b}.
\end{equation}
If $ \phi $ is a Euclidean norm as in definition, can use $ \phi $ to construct $ \psi $ Euclidean norm satisfying $ \rb{\ref{eq:1}} $.

\begin{theorem}
If $ R $ is a Euclidean domain, then $ R $ is a PID, so $ R $ is a UFD.
\end{theorem}

\lecture{5}{Monday}{21/01/19}

\begin{proof}
Let $ I \subseteq R $ be an ideal. Assume $ I \ne \ab{0} $. Goal is that $ I $ is generated by one element $ a \in R \setminus \cb{0} $. Let $ 0 \ne a \in I $ be an element such that $ \phi\rb{a} $ is minimal along the values of $ \phi $ on $ I $. $ \ab{a} \subseteq I $. We will show that we have an equality. Let $ b \in I \setminus \ab{a} $. Apply property of $ \phi $ to $ b $ and $ a $, $ b = qa + r $. $ r \ne 0 $, otherwise $ a \mid b $ gives $ b \in \ab{a} $. $ r = b - qa \in I $ but $ \phi\rb{r} < \phi\rb{a} $, a contradiction.
\end{proof}

\begin{example*}
\hfill
\begin{itemize}
\item $ \Z $, with Euclidean norm
$$ \function{\Z \setminus \cb{0}}{\Z_{\ge 1}}{n}{\abs{n}}. $$
\item Gaussian integers. $ \Z\sb{i} $, with Euclidean norm given by restriction to $ \Z\sb{i} \subset \C $ of complex absolute value
$$ \function{\Z^2 \setminus \cb{\rb{0, 0}}}{\Z_{\ge 1}}{a + ib}{\rb{a + ib}\rb{a - ib} = a^2 + b^2}. $$
\item Eisenstein integers. Let $ 1 \ne \omega \in \C $ be a primitive cube root of unity, so $ \omega = \tfrac{-1 + \sqrt{-3}}{2} $. The subring
$$ \Z\sb{\omega} = \cb{a + b\omega \mid a, b \in \Z} \subset \C $$
is Euclidean, with Euclidean norm given by
$$ \function{\Z^2 \setminus \cb{\rb{0, 0}}}{\Z_{\ge 1}}{a + b\omega}{a^2 - ab + b^2}. $$
\end{itemize}
\end{example*}

\begin{remark*}
\hfill
\begin{itemize}
\item In all these examples, norm is multiplicative. This does not have to hold true, such as $ \Q\sb{x} $, with Euclidean norm $ f \mapsto \deg\rb{f} $.
\item There are PIDs that do not admit a Euclidean norm, such as $ \Z\sb{\tfrac{1 + \sqrt{-19}}{2}} $.
\end{itemize}
\end{remark*}

\subsection{Summary of rings}

$$ \cb{\text{commutative rings}} \supsetneq \cb{\text{IDs}} \supsetneq \cb{\text{UFDs}} \supsetneq \cb{\text{PIDs}} \supsetneq \cb{\text{Euclidean domains}}. $$
\begin{itemize}
\item $ \Q\sb{x, y} / xy $, $ \Z / 6\Z $, $ \F_3\sb{x} / x^2 $ are commutative rings but not IDs.
\item $ \Z\sb{\sqrt{-5}} $ is an ID but not a UFD, since $ 6 = 2 \cdot 3 = \rb{1 + \sqrt{-5}} \cdot \rb{1 - \sqrt{-5}} $.
\item $ \Z\sb{x} $ is a UFD but not a PID, since $ \ab{2, x} $ is not principal.
\item $ \Z\sb{\tfrac{1 + \sqrt{-19}}{2}} $ is a PID but not a Euclidean domain.
\end{itemize}

\pagebreak

\subsection{Gaussian integers}

The \textbf{Gaussian integers} are
$$ \Z\sb{i} = \cb{a + bi \mid a, b \in \Z} \subset \Q\rb{i} \subset \C. $$
We will crucially use the norm
$$ \function[N]{\Z\sb{i}}{\Z_{\ge 0}}{a + bi}{\rb{a + bi}\rb{a - bi} = a^2 + b^2}, $$
which is not the same as the Euclidean norm.

\begin{note*}
This is multiplicative.
\end{note*}

\begin{proposition}
If $ u \in \Z\sb{i}^\times $ then $ N\rb{u} = 1 $.
\end{proposition}

\begin{proof}
$ N \mid_{\Z\sb{i} \setminus \cb{0}}\rb{u} \ge 1 $, $ N $ is multiplicative, and $ N\rb{1} = 1 $. $ uv = 1 $ gives $ N\rb{u} \cdot N\rb{v} = 1 $, so $ N\rb{u} \ge 1 $ and $ N\rb{v} \ge 1 $ gives $ N\rb{u} = N\rb{v} = 1 $.
\end{proof}

$ N\rb{u} = u \cdot \overline{u} = 1 $. $ u = a + bi \in \Z\sb{i}^\times $ if and only if $ a^2 + b^2 = 1 $, if and only if $ \rb{a, b} = \rb{\pm 1, 0} $, that is $ u = \pm 1 $, or $ \rb{a, b} = \rb{0, \pm 1} $, that is $ u = \pm i $.

\begin{remark*}
$ \Z\sb{i}^\times \cong \rb{\Z / 4\Z, +} $ as groups.
\end{remark*}

\begin{proposition}
Given $ \alpha, \beta \in \Z\sb{i} $, $ \beta \ne 0 $, there exist $ \kappa, \lambda \in \Z\sb{i} $ such that $ \alpha = \kappa\beta + \lambda $ and either $ \lambda = 0 $ or $ N\rb{\lambda} < N\rb{\beta} $, so $ N $ is Euclidean and $ \Z\sb{i} $ has unique factorisation.
\end{proposition}

\begin{proof}
$ \Z\sb{i} \subset \C $ is a lattice. $ \alpha = \kappa\beta + \lambda $ if and only if $ \alpha / \beta = \kappa + \lambda / \beta $ in $ \C $ for $ \beta \ne 0 $. $ \alpha / \beta \in \C $ lands inside one of the unit squares in the lattice spanned by $ \Z\sb{i} $. Open unit discs centred at the vertices of the unit square cover the entire square. $ \alpha / \beta $ is in the unit disc centred at $ \kappa $ if and only if $ N\rb{\alpha / \beta - \kappa} < 1 $. Let $ \lambda / \beta = \alpha / \beta - \kappa $ and $ N\rb{\lambda / \beta} < 1 $ if and only if $ N\rb{\lambda} < N\rb{\beta} $. Choose $ \kappa $ to be one vertex such that $ \alpha / \beta $ is in the open unit disc centred at $ \kappa $. $ \lambda = \beta\rb{\alpha / \beta - \kappa} $ gives $ N\rb{\lambda} < N\rb{\beta} $.
\end{proof}

\begin{lemma}[Special case of quadratic reciprocity]
If $ p $ is an odd prime, then $ -1 $ is a square mod $ p $ if and only if $ p \equiv 1 \mod 4 $.
\end{lemma}

The following is the decomposition of primes in $ \Z\sb{i} $.
\begin{itemize}
\item $ 2 = \rb{1 + i}\rb{1 - i} = \rb{-i}\rb{1 + i}^2 $. Notice that $ i\rb{1 + i} = i - 1 = -\rb{1 - i} $. Up to units in $ \Z\sb{i}^\times $ these prime factors are the same. This is a \textbf{ramified} prime.
\item $ p \equiv 1 \mod 4 $. $ p = \rb{a + bi}\rb{a - bi} $, which are distinct primes in $ \Z\sb{i} $. This is a \textbf{split} prime.
\item $ p \equiv 3 \mod 4 $. $ p $ stays prime. If not, $ a + bi \mid p $, so $ N\rb{a + bi} \mid N\rb{p} = p^2 $ gives $ N\rb{a + bi} = p = a^2 + b^2 $, which cannot happen. This is an \textbf{inert} prime.
\end{itemize}

\lecture{6}{Tuesday}{22/01/19}

Quadratic reciprocity gives that there exists $ n \in \Z $ such that $ p \mid n^2 + 1 = \rb{n + i}\rb{n - i} $. Assume $ p $ stays prime, or irreducible, in $ \Z\sb{i} $, so $ p \mid n + i $ or $ p \mid n - i $. By conjugating, we see $ p \mid n + i $ if and only if $ p \mid n - i $, so $ p \mid \rb{n + i} - \rb{n - i} = 2i $. Taking $ N $, see $ N\rb{p} = p^2 \nmid 4 = N\rb{2i} $, a contradiction.

\begin{theorem}
$ n \in \Z_{> 0} $ is of the form $ n = a^2 + b^2 $ for $ a, b \in \Z $ if and only if for all $ p \mid n $ such that $ p \equiv 3 \mod 4 $ the exponent of $ p $ in $ n $ is even.
\end{theorem}

\begin{theorem}
The only solutions to the Diophantine equation $ x^2 + 1 = y^3 $ are $ x = 0 $ and $ y = 1 $.
\end{theorem}

\begin{proof}
$ \rb{x + i}\rb{x - i} = y^3 $. Are $ x + i, x - i $ coprime in $ \Z\sb{i} $? If $ \pp $ is a prime of $ \Z\sb{i} $ dividing both, then $ \pp \mid 2i $, that is $ N\rb{\pp} \mid 4 $, so $ 2 \mid y $ gives $ 8 \mid y^3 $. But $ x^3 + 1 \equiv 1, 2, 5 \mod 8 $ gives $ \gcd\rb{x + i, x - i} = 1 $, so
$$
\begin{cases}
x + i = uz^3 = \rb{uz}^3 \\
x - i = \overline{u}\overline{z}^3 = \rb{\overline{u}\overline{z}}^3
\end{cases},
$$
for $ u \in \cb{\pm 1, \pm i} $. $ x - i = \rb{a + bi}^3 = a^3 - b^3i + 3a^2bi - 3ab^2 $ for some $ a, b \in \Z $. Looking at coefficients of $ i $, $ 1 = 3a^2b - b^3 $, so $ a = 0 $ and $ b = -1 $. Plugging this back in we get $ x = 0 $ and $ y = 1 $.
\end{proof}

\pagebreak

\subsection{Eisenstein integers}

The \textbf{Eisenstein integers} are $ \Z\sb{\omega} $ for $ \omega = \tfrac{-1 + \sqrt{-3}}{2} $. This is a subring of $ \C $, since
$$ \rb{a + b\omega}\rb{c + d\omega} = ac + \rb{ad + bc}\omega + bd\omega^2 = \rb{ac - bd} + \rb{ad + bc - bd}\omega. $$
What is $ \Z\sb{\sqrt{-3}} \subset \Z\sb{\omega} $? Both are subrings of $ \Q\rb{\sqrt{-3}} = \Q\sb{x} / \ab{x^3 + 3} $.
\begin{itemize}
\item In $ \Z\sb{\sqrt{-3}} $, $ 4 = 2 \cdot 2 = \rb{1 + \sqrt{-3}} \cdot \rb{1 - \sqrt{-3}} $, where $ 2, 1 + \sqrt{-3}, 1 - \sqrt{-3} $ are all irreducible.
\item $ \pi = \tfrac{1 + \sqrt{-3}}{2} $ is a unit in $ \Z\sb{\omega} $ and $ \pi^6 = 1 $, but $ \pi \notin \Z\sb{\sqrt{-3}} $.
\item $ \Z\sb{\sqrt{-3}} $ is not integrally closed in $ \Q\rb{\sqrt{-3}} $, but $ \Z\sb{\omega} $ is its integral closure and it is integrally closed in $ \Q\rb{\sqrt{-3}} $.
\item $ \omega^2 + \omega + 1 = 0 $, so $ \omega $ is an algebraic integer in $ \Z\sb{\omega} \setminus \Z\sb{\sqrt{-3}} $.
\end{itemize}

\begin{proposition}
If $ u \in \Z\sb{\omega}^\times $ then $ N\rb{u} = 1 $, where
$$ \function[N]{\Z\sb{\omega}}{\Z}{a + b\omega}{\rb{a + b\omega}\rb{a + b\overline{\omega}} = a^2 - ab + b^2}. $$
\end{proposition}

\begin{proof}
Multiplicative because it is the restriction of $ z \in \C \mapsto \abs{z}^2 $ to $ \Z\sb{\omega} $. Holds true in any imaginary quadratic field $ \Q\rb{\sqrt{-d}} $.
\end{proof}

$ a^2 - ab + b^2 = 1 $ if and only if $ \rb{a, b} = \rb{\pm 1, 0} $, that is $ u = \pm 1 $, or $ \rb{a, b} = \rb{0, \pm 1} $, that is $ u = \pm\omega $, or $ \rb{a, b} = \pm\rb{1, 1} $, that is $ u = \pm\rb{1 + \omega} = \pm\pi $.

\begin{remark*}
$ \Z\sb{\omega}^\times \cong \rb{\Z / 6\Z, +} $.
\end{remark*}

\begin{theorem}
$ \Z\sb{\omega} $ is a Euclidean domain, with Euclidean norm given by $ N\rb{a + b\omega} = a^2 - ab + b^2 $.
\end{theorem}

\begin{proof}
Let $ \alpha, \beta \in \Z\sb{\omega} \setminus \cb{0} $. There exists $ \kappa, \lambda \in \Z\sb{\omega} $ such that $ \alpha = \kappa\beta + \lambda $ and $ N\rb{\lambda} < N\rb{\beta} $. Use geometric proof. $ \Z\sb{\omega} = \cb{a + b\omega \mid a, b \in \Z} \subset \C $ is tiled by parallelograms of $ \C $, which are translates of a parallelogram at $ \pi $. Want to take $ \kappa $ to be a vertex of a parallelogram such that $ N\rb{\kappa - \alpha / \beta} < 1 $. Parallelogram covered by interior of unit discs centred at lattice points, so ok. Let $ \lambda = \beta\rb{\alpha / \beta - \kappa} $, so $ N\rb{\lambda} / N\rb{\beta} < 1 $.
\end{proof}

\lecture{7}{Friday}{25/01/19}

Lecture 7 is a problem class.

\lecture{8}{Monday}{28/01/19}

\begin{lemma}[Special case of quadratic reciprocity]
If $ p \ne 3 $ is an odd prime, then $ -3 $ is a square mod $ p $ if and only if $ p \equiv 1 \mod 3 $.
\end{lemma}

The following is the decomposition of primes in $ \Z\sb{\omega} $.
\begin{itemize}
\item $ 3 $ ramifies. $ 3 = -\rb{\sqrt{-3}}^2 $, which is irreducible in $ \Z\sb{\omega} $.
\item $ p \equiv 2 \mod 3 $ stays inert in $ \Z\sb{\omega} $. Because $ N $ is multiplicative and $ p $ cannot be written as $ a^2 - ab + b^2 $ with $ a, b \in \Z $.
\item $ p \equiv 1 \mod 3 $ splits as a product of distinct prime factors $ \pp, \overline{\pp} \in \Z\sb{\omega} $. $ p $ divides $ a^2 - ab + b^2 $ with $ a, b \in \Z $ and $ p \nmid a, b $, so $ p $ divides $ \rb{2a - b}^2 + 3b^2 $. Take $ z \in \Z $ odd such that $ z^2 \equiv -3 \mod p $, and let $ b = 1 \in \Z $ and $ a = \rb{z + 1} / 2 \in \Z $. To show that $ p $ splits in $ \Z\sb{\omega} $, let $ p \mid a^2 - a + 1 = \rb{a + \omega}\rb{a + \overline{\omega}} $ for $ z \in \Z $. Using unique factorisation, $ p \mid a + \omega $ or $ p \mid a + \overline{\omega} $. In fact, since $ a + \omega, a + \overline{\omega} $ are complex conjugates, $ p \mid a + \omega $ and $ p \mid a + \overline{\omega} $, so $ p \mid \omega - \overline{\omega} = \tfrac{-1 + \sqrt{-3}}{2} - \tfrac{-1 - \sqrt{-3}}{2} = \sqrt{-3} $. But $ \rb{3, p} = 1 $, a contradiction. Thus $ p = \pp\overline{\pp} = N\rb{\pp} $. Check that $ \pp / \overline{\pp} \ne u \in \Z\sb{\omega}^\times $, (Exercise) so $ p $ splits.
\end{itemize}

\begin{remark*}
These three possible behaviours have to do with the structure of $ \Z\sb{\omega} / \ab{p} $.
\begin{itemize}
\item If this is a field, $ p $ is inert.
\item If this is of the form $ \F_1 \times \F_2 $, $ p $ is split.
\item If this is of the form $ \F\sb{\epsilon} / \ab{\epsilon^2} $, $ p $ is ramified.
\end{itemize}
\end{remark*}

\pagebreak

\subsection{Other Euclidean domains}

\begin{itemize}
\item $ \Z\sb{\omega} $ and $ \Z\sb{i} $ are norm Euclidean. Using geometric proof, $ \Z\sb{i}, \Z\sb{\omega} \subset \C $ are lattices.
\item $ \Z\sb{\sqrt{-5}} $ is not a UFD, so not Euclidean, since
$$ 6 = 2 \cdot 3 = \rb{1 + \sqrt{-5}}\rb{1 - \sqrt{-5}}. $$
What goes wrong if we try to adapt geometric proof from $ \Z\sb{i}, \Z\sb{\omega} $? Unit discs do not cover all of the area of $ \C $.
\item The ring of integers $ \OO_7 \subset \Q\rb{\sqrt{-7}} $ and $ \OO_{11} \subset \Q\rb{\sqrt{-11}} $ both are norm Euclidean. Adopt proof from $ \Z\sb{i}, \Z\sb{\omega} $.
\item It is hard to tell which fields are Euclidean and which are not. For example, $ \Z\sb{\tfrac{1 + \sqrt{-19}}{2}} $ is not Euclidean but is a PID and a UFD.
\item Among real quadratic fields, $ \Z\sb{\sqrt{2}} $ is Euclidean. The same geometric proof will not work because $ \Z\sb{\sqrt{2}} \subset \R $. (Exercise: $ \Z\sb{\sqrt{2}} $ is dense in $ \R $) We do have a geometric way to think about this.
$$ \dfrac{\Q\rb{\sqrt{2}}}{\Q} = \cb{a + b\sqrt{2} \mid a, b \in \Q} $$
is a two-dimensional $ \Q $-vector space.
$$ \function[\sigma]{\Q\rb{\sqrt{2}}}{\Q\rb{-\sqrt{2}}}{a + b\sqrt{2}}{a - b\sqrt{2}} $$
is a field automorphism that preserves $ \Q $.
$$
\begin{array}{rcl}
\Z\sb{\sqrt{2}} \subset \Q\rb{\sqrt{2}} & \hookrightarrow & \R^2 \\
a + b\sqrt{2} & \mapsto & \rb{a + b\sqrt{2}, a - b\sqrt{2}} \\
1 & \mapsto & \theta_1 = \rb{1, 1} \\
\sqrt{2} & \mapsto & \theta_2 = \rb{\sqrt{2}, -\sqrt{2}}
\end{array}.
$$
$ \theta_1, \theta_2 $ generate a lattice in $ \R^2 $. Can do a geometric proof in this, but use $ N\rb{x, y} = x \cdot y $ and areas under hyperbolas.
\end{itemize}

\pagebreak

\section{Ring of integers in number fields}

\lecture{9}{Tuesday}{29/01/19}

Useful for describing the ring of integers $ \OO_K \subset K $ for a finite extension $ K / \Q $ and $ \OO^\times $, the group of units in $ \OO_K $, by Dirichlet's unit theorem.

\subsection{Modules}

\begin{definition}
Let $ R $ be a ring. An \textbf{$ R $-module} $ M $ is a set, together with
\begin{itemize}
\item an additive structure on $ M $
$$ m_1, m_2 \in M \qquad \implies \qquad m_1 + m_2 \in M, $$
\item an action of $ R $ on $ M $,
$$ \function{R \times M}{M}{\rb{r, m}}{rm} $$
satisfying
\begin{itemize}
\item $ r\rb{m_1 + m_2} = rm_1 + rm_2 $,
\item $ 1 \cdot m = m $,
\item $ r_1\rb{r_2m} = \rb{r_1r_2}m $,
\item $ \rb{r_1 + r_2}m = r_1m + r_2m $, and
\item $ 0 \cdot m = 0 $.
\end{itemize}
\end{itemize}
\end{definition}

\begin{note*}
\hfill
\begin{itemize}
\item If $ R $ is a field, then an $ R $-module is just an $ R $-vector space.
\item If $ R = \Z $, a $ \Z $-module $ M $ is an abelian group.
\end{itemize}
\end{note*}

\begin{definition}
A \textbf{free $ \Z $-module of rank $ n $} is a $ \Z $-module $ M $ which has a basis $ \rb{e_1, \dots, e_n} $ such that all $ m \in M $ can be written uniquely as $ a_1e_1 + \dots + a_ne_n $ for $ a_1, \dots, a_n \in \Z $.
\end{definition}

\begin{example*}
\hfill
\begin{itemize}
\item $ \Z $ is a free $ \Z $-module of rank one.
\item $ \Z^n = \cb{\rb{a_1, \dots, a_n} \mid a_i \in \Z} $ is a free $ \Z $-module of rank $ n $. Any free $ \Z $-module of rank $ n $ is isomorphic to $ \Z^n $, so there exists $ \phi : M \xrightarrow{\sim} \Z^n $, where $ M $ is free of rank $ n $, such that $ \phi\rb{m_1 + m_2} = \phi\rb{m_1} + \phi\rb{m_2} $, and $ \phi\rb{nm} = n\phi\rb{m} $ that is redundant once you respect addition.
\item $ \Z / 3\Z $ is not free because $ 3 \cdot 1 = 0 $. $ 0 $ is not written uniquely in terms of basis.
\item Any finite abelian group is a $ \Z $-module, but not free.
\item $ \Q = \cb{r / s \mid \rb{r, s} = 1, \ r, s \in \Z, \ s > 0} $ is a $ \Z $-module but it is not free of finite rank. Assume that $ \Q $ was free of rank $ n $, for some $ n \in \Z_{\ge 0} $. Let $ e_1 = r_1 / s_1, \dots, e_n = r_n / s_n $ be a basis. Then
$$ \dfrac{1}{s_1 \cdot \dots \cdot s_n + 1} \notin e_1\Z \oplus \dots \oplus e_n\Z, $$
a contradiction. Alternatively, prove that $ e_1 $ and $ e_2 $ are linearly dependent over $ \Z $, so rank would have to be one, and argue as above.
\item $ \Z\sb{i}, \Z\sb{\omega}, \Z\sb{\sqrt{-5}} $ are free $ \Z $-modules of rank two. We will later see that the ring of integers $ \OO_K \subset K $ is a free $ \Z $-module of rank equal to the rank of $ K / \Q $, or $ \dim_\Q\rb{K} $.
\end{itemize}
\end{example*}

\pagebreak

\subsection{Structure theorem for finitely generated abelian groups}

\begin{theorem}[Structure theorem, weak form]
Let $ M $ be a free $ \Z $-module of finite rank $ n $, and $ M' \subseteq M $ be a $ \Z $-submodule. Then $ M' $ is free of rank $ m \le n $.
\end{theorem}

\begin{proof}
We will prove this by induction on $ n = rk\rb{M} $. We have a basis $ e_1, \dots, e_n $ of $ M $ and projections
$$ \function[p_i]{M}{\Z}{a_1e_1 + \dots + a_ne_n}{a_i}, $$
which are module homomorphisms. If $ p_i\rb{M'} = 0 $ for every $ i = 1, \dots, n $, then $ M' = 0 $. If $ M' \ne 0 $, we can assume without loss of generality that $ p_1\rb{M'} \ne 0 $.
\begin{itemize}
\item $ p_1\rb{M'} $ will be an ideal of $ \Z $, therefore it will be a principal ideal. There exists $ x \in M' $ such that $ p_1\rb{M'} = \ab{p_1\rb{x}} $.
\item $ N = Ker\rb{p_1} \hookrightarrow M $ is a submodule of $ M $ free of rank $ n - 1 $ because it is generated by $ e_2, \dots, e_n $.
\end{itemize}
Consider $ N' = N \cap M' $, a submodule of $ N, M', M $. We have an isomorphism of $ \Z $-modules
$$ N' \oplus x\Z = \cb{n' + n \cdot x \mid n' \in N', \ n \in \Z} \cong M'. $$
(Exercise: prove) $ N $ is free of rank $ n - 1 $, so by induction hypothesis $ N' $ is free of rank $ m' \le n - 1 $. $ M' $ is free of rank $ m' + 1 \le n $. Have a basis $ \rb{e_1', \dots, e_m', x} $ for $ M' $, where $ \rb{e_1, \dots, e_m'} $ is a basis for $ N' $.
\end{proof}

\begin{theorem}[Structure theorem, strong form]
\label{thm:structure}
Let $ M $ be a free $ \Z $-module of rank $ n $. Let $ M' \subseteq M $ be a submodule. Then there exist
\begin{itemize}
\item a basis $ \rb{e_1, \dots, e_n} $ of $ M $, and
\item $ a_1, \dots, a_q \in \Z \setminus \cb{0} $ for $ q \le n $ such that $ M' $ has a basis $ \rb{a_1e_1, \dots, a_qe_q} $ and such that $ a_1 \mid \dots \mid a_q $.
\end{itemize}
\end{theorem}

\begin{corollary}
\label{cor:structure}
Let $ G $ be a finitely generated abelian group. Then there exist $ a_1, \dots, a_n \in \Z $ such that $ a_1 \mid \dots \mid a_n $ and
$$ G \cong \dfrac{\Z}{a_1\Z} \times \dots \times \dfrac{\Z}{a_n\Z}. $$
\end{corollary}

\lecture{10}{Friday}{01/02/19}

\begin{remark*}
In Corollary \ref{cor:structure}, we are allowing $ a_i = 0 $ for some $ i \in \cb{1, \dots, n} $.
\end{remark*}

\begin{proof}
Consider $ e_1, \dots, e_n $, the generators of $ G $, and let $ M $ be the free $ \Z $-module spanned by $ e_1, \dots, e_n $. $ \phi : M \twoheadrightarrow G $ is a surjective $ \Z $-module homomorphism. Have isomorphism of $ \Z $-modules $ M / M' \subseteq G $, induced by $ \phi $. Theorem \ref{thm:structure} gives
$$ M = e_1\Z \oplus \dots \oplus e_n\Z, \qquad M' = a_1e_1\Z \oplus \dots \oplus a_qe_q\Z, $$
where $ a_{q + 1} = \dots = a_n = 0 $. Thus
$$ \dfrac{M}{M'} \cong \dfrac{\Z}{a_1\Z} \times \dots \times \dfrac{\Z}{a_q\Z} \times \dfrac{\Z}{a_{q + 1}\Z} \times \dots \times \dfrac{\Z}{a_n\Z} \cong \dfrac{\Z}{a_1\Z} \times \dots \times \dfrac{\Z}{a_q\Z} \times \Z \times \dots \times \Z. $$
\end{proof}

\begin{lemma}
\label{lem:1}
Let $ M $ be a free $ \Z $-module of rank $ n $, and $ x \in M $. Let $ p_1 : M \to \Z $ and $ p_2 : M \to \Z $. There exists a homomorphism $ M \to \Z $ such that $ p\rb{x} \mid p_1\rb{x} $ and $ p\rb{x} \mid p_2\rb{x} $.
\end{lemma}

\begin{proof}
Find $ a, b \in \Z $ such that $ \gcd\rb{p_1\rb{x}, p_2\rb{x}} = ap_1\rb{x} + bp_2\rb{x} $, by Euclid's algorithm. Define $ p = ap_1 + bp_2 $.
\end{proof}

\begin{lemma}
\label{lem:2}
Let $ R $ be a PID. Let $ S $ be a set of ideals of $ R $. There exists an ideal $ I \in S' $ such that $ I \subseteq J $ and $ J \in S' $ gives $ I = J $, that is such that $ I $ is maximal with respect to inclusion.
\end{lemma}

\begin{proof}
We will use the ascending chain condition, ok because $ R $ is a PID, to argue by contradiction. If Lemma \ref{lem:2} were not true, would set $ I_1 \subsetneq I_2 \subsetneq \dots $ with $ I_i \in S $, a contradiction.
\end{proof}

\begin{lemma}
\label{lem:3}
Let $ M $ be a free $ \Z $-module of rank $ n $, and $ x \in M $. Then there exists a homomorphism $ p : M \to \Z $ such that $ p\rb{x} \mid q\rb{x} $ for every $ q : M \to \Z $.
\end{lemma}

\pagebreak

\begin{proof}
Look at the set of all ideals $ \ab{q\rb{x}} \subseteq \Z $. Applying Lemma \ref{lem:2}, there exists $ \ab{p\rb{x}} \subseteq \Z $, where $ p : M \to \Z $, which is maximal with respect to inclusion. Want $ p\rb{x} \mid q\rb{x} $ for all $ q : M \to \Z $. Applying Lemma \ref{lem:1} to $ p, q $ gives $ r : M \to \Z $ such that $ r\rb{x} \mid q\rb{x} $ and $ r\rb{x} \mid p\rb{x} $, so $ \ab{r\rb{x}} \supseteq \ab{p\rb{x}} $. Because $ p $ is maximal, have equality $ r\rb{x} \sim p\rb{x} $, so $ p\rb{x} \mid q\rb{x} $.
\end{proof}

\begin{proof}[Proof of Theorem \ref{thm:structure}]
Argue by induction on $ n = rk_\Z\rb{M} $.
\begin{itemize}
\item Let $ M' \subseteq M $. If $ p : M \to \Z $, then $ p\rb{M'} \subseteq M $. Choose $ p $ such that $ p\rb{M'} $ is maximal with respect to inclusion among all $ q : M \to \Z $.
\item What is $ p\rb{M} \subseteq \Z $? We have $ p\rb{M} = a\Z $ for $ a \in \Z \setminus \cb{0} $. If $ a \ne \pm 1 $, could define $ p'\rb{x} = p\rb{x} / a $ for all $ x \in M $. $ p'\rb{M'} \supsetneq p\rb{M'} $ contradicts the maximality of $ p $ with respect to $ M' $. Thus $ p\rb{M} = \Z $.
\item Let $ N = Ker\rb{p} \subseteq M $, where $ p : M \twoheadrightarrow \Z $. $ N $ is free of rank $ n - 1 $, and $ N' = M' \cap N $ be a submodule.
$$
\begin{tikzcd}[row sep=small]
N' \arrow[hookrightarrow]{r} \arrow[hookrightarrow]{d} & N \arrow[hookrightarrow]{d} \\
M' \arrow[hookrightarrow]{r} \arrow[twoheadrightarrow]{d} & M \arrow[twoheadrightarrow]{d} \\
p\rb{M'} \arrow[hookrightarrow]{r} & \Z
\end{tikzcd}.
$$
\item Apply induction hypothesis to $ \rb{N, N'} $. $ N $ has a basis $ \rb{e_2, \dots, e_n} $. Can complete $ \rb{e_2, \dots, e_n} $ to a basis for $ M $. Choose $ e_1' \in M $ such that $ p\rb{e_1'} = 1 $. Have a basis $ \rb{e_1', e_2, \dots, e_n} $ of $ M $.
\item There exist $ a_2, \dots, a_q \in \Z \setminus \cb{0} $ such that $ N' $ has a basis $ \rb{a_2e_2, \dots, a_qe_q} $ and $ a_2 \mid \dots \mid a_q $. $ M' \twoheadrightarrow p\rb{M'} = a_1\Z $ for $ a_1 \in \Z \setminus \cb{0} $, assuming $ M' \ne 0 $. Choose $ x \in M' $ such that $ p\rb{x} = a_1 $. We may assume $ p\rb{x} \mid q\rb{x} $ for every $ q : M \to \Z $. Look at $ \rb{e_1', e_2, \dots, e_n} $, a basis of $ M $. Let $ p_i : M \to \Z $ be the projection onto the $ i $-th coordinate. $ a_1 \mid p_i\rb{x} $ for all $ i = 1, \dots, n $, by maximality property of $ p $ and $ p\rb{x} = a_1 $. Can find a basis $ \rb{e_1, \dots, e_n} $ of $ M $ such that $ x = a_1e_1 $, where
$$ e_1 = e_1' + \dfrac{p_2\rb{x}}{a_1}e_2 + \dots + \dfrac{p_n\rb{x}}{a_1}e_n, \qquad p_2\rb{x} / a_1, \dots, p_n\rb{x} / a_1 \in \Z. $$
\item Left to prove that $ a_1 \mid a_2 $. Let $ d = \rb{a_1, a_2} = b_1a_1 + b_2a_2 $. There exists $ d : M \to \Z $ such that $ d\rb{x} = b_1p_1\rb{x} + b_2p_2\rb{x} $, where $ p_1\rb{x} = p\rb{x} = a_1 $ and $ p_2\rb{x} = a_2 $. This will contradict maximality of $ p_1 = p $.
\end{itemize}
\end{proof}

\lecture{11}{Monday}{04/02/19}

\begin{definition}
\hfill
\begin{itemize}
\item If $ M $ is a $ \Z $-module, an element $ x \in M \setminus \cb{0} $ is called a \textbf{torsion element} if there exists $ a \in \Z \setminus \cb{0} $ such that $ ax = 0 $.
\item We say that a $ \Z $-module $ M $ is \textbf{torsion-free} if it does not contain torsion elements, that is if $ ax = 0 $ for $ a \in \Z $ and $ x \in M $, then $ a = 0 $ or $ x = 0 $.
\end{itemize}
\end{definition}

\begin{example*}
\hfill
\begin{itemize}
\item If $ G $ is any finite group, all elements of $ G $ are torsion.
\item If $ M $ is a free $ \Z $-module, then $ M $ is torsion-free, such as $ \Z^n $ for $ n \in \Z_{\ge 1} $.
\item $ \Q $ is torsion-free, even though it is not free of finite rank.
\end{itemize}
\end{example*}

\begin{proposition}
If $ M $ is a finitely generated $ \Z $-module and $ M $ is torsion-free, then $ M $ is free of finite rank.
\end{proposition}

\begin{proof}
Using structure theorem,
$$ M \cong \dfrac{\Z}{a_1\Z} \times \dots \times \dfrac{\Z}{a_n\Z}, $$
with $ a_1, \dots, a_n \in \Z $ satisfying $ a_1 \mid \dots \mid a_n $. Want $ a_1 = \dots = a_n = 0 $. If not, there exists $ a_i \ne 0 $ such that all $ x \in \Z / a_i\Z \setminus \cb{0} $ are torsion elements, so $ M $ cannot be a torsion-free, a contradiction.
\end{proof}

\pagebreak

\subsection{Integral elements}

\begin{definition}
An element $ x \in \C $ is called
\begin{itemize}
\item an \textbf{algebraic number} if it satisfies an equation
$$ x^n + a_{n - 1}x^{n - 1} + \dots + a_0 = 0, $$
with all $ a_i \in \Q $, and
\item an \textbf{algebraic integer} if $ a_i \in \Z $.
\end{itemize}
\end{definition}

\begin{example*}
\hfill
\begin{itemize}
\item $ x = i $ is an algebraic integer, since $ x^2 + 1 = 0 $.
\item $ x = \sqrt{2} $ is an algebraic integer, since $ x^2 - 2 = 0 $.
\item $ x = \sqrt{2} + i $ is an algebraic integer, since
$$ x - \sqrt{2} = i \qquad \implies \qquad x^2 - 2\sqrt{2}x + 3 = 0 \qquad \implies \qquad x^4 - 2x^2 + 9 = 0. $$
\end{itemize}
\end{example*}

In general, sum of product of algebraic integers are algebraic integers.

\begin{definition}
Let $ R $ be a ring and $ A \subseteq R $. An element $ x \in R $ is said to be \textbf{integral} over $ A $ if there exists a monic polynomial equation
$$ x^n + a_{n - 1}x^{n - 1} + \dots + a_0 = 0, $$
with $ a_i \in A $ for $ i = 0, \dots, n - 1 $.
\end{definition}

\begin{theorem}
\label{thm:integralsubring}
Let $ R $ be an ID and $ A \subseteq R $ a subring. Then if $ a, b \in R $ are integral over $ A $, so are $ a + b, a - b, ab $.
\end{theorem}

\begin{lemma}
\label{lem:cayleyhamilton}
Let $ R $ be an ID. Let
$$ M = \rb{a_{ij}}_{1 \le i, j \le n} \in M_n\rb{R} $$
be an $ n \times n $ matrix with coefficients in $ R $. Assume $ v = \rb{v_1, \dots, v_n} \in R^n $ for $ x \in R $ such that $ Mv = x \cdot v $, that is $ v $ is an eigenvector of $ M $ with eigenvalue $ x $. Let $ P \in R\sb{X} $ be the characteristic polynomial of $ M $. Then $ P\rb{x} = 0 $, that is $ x $ is a root of $ P $.
\end{lemma}

\begin{proof}
$$ P\rb{X} = \det\rb{X \cdot I_n - M} = X^n + a_{n - 1}X^{n - 1} + \dots + a_0 $$
is monic of degree $ n $ with coefficients in $ R $. Cayley-Hamilton theorem gives
$$ M^n + a_{n - 1}M^{n - 1} + \dots + a_0I_n = 0_n \in R^n \qquad \implies \qquad M^nv + a_{n - 1}M^{n - 1}v + \dots + a_0I_nv = 0_n \in R^n. $$
Since $ Mv = x \cdot v $, we get
$$ x^n \cdot v + a_{n - 1}x^{n - 1} \cdot v + \dots + a_0 \cdot v = 0_n \in R^n \qquad \implies \qquad \rb{x^n + a_{n - 1}x^{n - 1} + \dots + a_0} \cdot v = 0_n \in R^n. $$
$ v \ne 0 $ gives
$$ x^n + a_{n - 1}x^{n - 1} + \dots + a_0 = 0 \in R, $$
so $ x $ is a root of $ P $.
\end{proof}

\pagebreak

\begin{proof}[Proof of Theorem \ref{thm:integralsubring}]
Let $ x = a + b $. Proof is similar for $ a - b $ and $ ab $. $ a $ is integral over $ A $, so there exists a polynomial $ f \in A\sb{x} $ for $ n = \deg\rb{f} $ such that
\begin{equation}
\label{eq:2}
f\rb{a} = a^n + a_{n - 1}a^{n - 1} + \dots + a_0 = 0,
\end{equation}
so $ a^n = -a_{n - 1}a^{n - 1} - \dots - a_0 $ is in the $ A $-linear span of $ a^{n - 1}, \dots, 1 $. Similarly for $ b $, there exists $ g \in A\sb{x} $ for $ m = \deg\rb{g} $ such that
\begin{equation}
\label{eq:3}
g\rb{b} = b^m + b_{m - 1}b^{m - 1} + \dots + b_0 = 0,
\end{equation}
so $ b^m $ is in the $ A $-linear span of $ b^{m - 1}, \dots, 1 $.
$$ \rb{a + b} \cdot a^ib^j = a^{i + 1}b^j + a^ib^{j + 1}, $$
for $ i = 0, \dots, n - 1 $ and $ j = 0, \dots, m - 1 $. If $ i + 1 = n $ use equation $ \rb{\ref{eq:2}} $. If $ j + 1 = m $ use equation $ \rb{\ref{eq:3}} $. Then $ \rb{a + b} \cdot a^ib^j $ is an $ A $-linear combination of $ a^kb^l $ for $ k \in \cb{0, \dots, n - 1} $ and $ l \in \cb{0, \dots, m - 1} $. Consider
$$ v = \threebyone{1}{\vdots}{a^{n - 1}b^{m - 1}} \in R^{m \cdot n}. $$
$ \rb{a + b} \cdot v = M \cdot v $ for some $ n \cdot m \times n \cdot m $ matrix $ M \in M_{n \cdot m}\rb{A} $. Lemma \ref{lem:cayleyhamilton} gives that $ a + b $ is a root of $ \det\rb{I_{n \cdot m}X - M} \in A\sb{X} $, that is $ a + b $ is integral over $ A $.
\end{proof}

\begin{corollary}
If $ R $ is an integral domain and $ A \subseteq R $. Then the set $ A' = \cb{x \in R \mid x \ \text{integral over} \ A} $ is a subring of $ R $, containing $ A $. $ A' $ is the \textbf{integral closure} of $ A $ in $ R $.
\end{corollary}

\begin{definition}
\hfill
\begin{itemize}
\item Let $ R $ be an ID with field of fractions $ K $. The \textbf{integral closure} of $ R $ is the integral closure of $ R $ in $ K $.
\item We say $ R $ is \textbf{integrally closed} if $ R $ is the integral closure of $ R $.
\end{itemize}
\end{definition}

\begin{example*}
\hfill
\begin{itemize}
\item $ \Z $ and $ \Z\sb{\omega} $ are integrally closed.
\item $ \Z\sb{x} $ is integrally closed.
\item $ R = \Z\sb{\sqrt{-3}} $ is not integrally closed. If $ \omega = \tfrac{-1 + \sqrt{-3}}{2} $ then $ \omega \in K = \Q\rb{\sqrt{-3}} $ and $ \omega^2 + \omega + 1 = 0 $, so $ \omega $ is integral over $ \Z\sb{\sqrt{-3}} $ but not in $ \Z\sb{\sqrt{-3}} $. Integral closure of $ \Z\sb{\sqrt{-3}} $ is $ \Z\sb{\omega} $, the Eisenstein integers.
\item $ \Q\sb{x, y} / \ab{x^2 - y^3} $ is not integrally closed. $ t = x / y \in Frac\rb{\Q\sb{x, y} / \ab{x^2 - y^3}} $ satisfies monic polynomial equations $ t^2 - y = 0 $ and $ t^3 - x = 0 $.
\end{itemize}
\end{example*}

\lecture{12}{Tuesday}{05/02/19}

\begin{proposition}
Let $ R $ be a UFD. Then $ R $ is integrally closed.
\end{proposition}

\begin{proof}
Let $ K = Frac\rb{R} $. Let $ x \in K $ be integral over $ R $. Want $ x \in R $. $ x $ satisfies a monic polynomial equation
\begin{equation}
\label{eq:4}
x^n + a_{n - 1}x^{n - 1} + \dots + a_0 = 0,
\end{equation}
for $ a_{n - 1}, \dots, a_0 \in R $. Write $ x = a / b $ with $ a, b \in R \setminus \cb{0} $. Can we ensure that $ a, b $ have no irreducible factor in common? Yes. Among all possible representations $ x = a / b $, choose the one for which $ d\rb{b} \in \Z_{\ge 0} $, the number of irreducible factors of $ b $, is the smallest. If $ \pp \mid a $ and $ \pp \mid b $ then $ a' = a / \pp $ and $ b' = b / \pp $, so $ x = a / b = a' / b' $, where $ d\rb{b'} = d\rb{b} - 1 $, a contradiction. Multiply $ \rb{\ref{eq:4}} $ by $ b^n $,
$$ a^n + a_{n - 1}a^{n - 1}b + \dots + a_0b^n = 0 \qquad \implies \qquad b\rb{a_{n - 1}a^{n - 1}b + \dots + a_0} = -a^n, $$
so $ b \mid a^n $, but $ \gcd\rb{a, b} = 1 $. Thus $ b \in R^\times $ is a unit, so $ x = a / b \in R $.
\end{proof}

\begin{theorem}
Let $ R \subset S $ be an inclusion of IDs. Let $ R' $ be the integral closure of $ R $ in $ S $. Then $ R' $ is integrally closed in $ S $.
\end{theorem}

\begin{example*}
Let $ \Z \subset R $, where $ R / \Q $ is a finite extension. Let $ \OO_K $ be the integral closure of $ \Z $ in $ K $, the ring of integers of $ K $. Then $ \OO_K $ is integrally closed. Applies to $ \Z\sb{i}, \Z\sb{\omega}, \Z\sb{\sqrt{-5}} $.
\end{example*}

\pagebreak

\subsection{Quadratic fields}

A \textbf{number field} $ K $ is a field containing $ \Q $ such that $ \dim_\Q\rb{K} $ is finite. Any finite field extension of $ \Q $ is a number field. The \textbf{degree} of the number field is by definition $ \dim_\Q\rb{K} $. A \textbf{quadratic field} is an extension of $ \Q $ of degree two. The \textbf{ring of integers} $ \OO_K \subset K $ is the integral closure of $ \Z $ in $ K $.

\begin{lemma}
Every quadratic field $ K / \Q $ is of the form
$$ \Q\rb{\sqrt{d}} = \cb{a + b\sqrt{d} \mid a, b \in \Q}, $$
for some square-free $ d \in \Z $.
\end{lemma}

\begin{proof}
Let $ x \in K \setminus \Q $. Then $ \ab{1, x} $ is a $ \Q $-basis of $ K $. $ x^2 + \alpha x + \beta \in K $ for $ \alpha, \beta \in \Q $ gives $ x = \rb{\alpha \pm\sqrt{\alpha^2 + 4\beta}} / 2 $, and $ d = \alpha^2 + 4\beta \in \Q $, so $ K = \Q\rb{\sqrt{d}} $. Multiplying $ d $ by $ n^2 $, for all $ n \in \Z $, $ \Q\rb{\sqrt{d}} = \Q\rb{\sqrt{dn^2}} $, so can assume $ d \in \Z $. Similarly, can assume $ d $ is square-free. Thus $ \ab{1, \sqrt{d}} $ is a basis over $ \Q $.
\end{proof}

\begin{remark*}
If $ d < 0 $, $ \Q\rb{\sqrt{d}} $ is called an \textbf{imaginary quadratic field}. If $ d > 0 $, $ \Q\rb{\sqrt{d}} $ is called a \textbf{real quadratic field}.
\end{remark*}

\begin{theorem}
Let $ K = \Q\rb{\sqrt{d}} $ with $ d \in \Z $ square-free. Note that $ d \not\equiv 0 \mod 4 $.
\begin{enumerate}
\item If $ d \equiv 2, 3 \mod 4 $ then
$$ \OO_K = \Z\sb{\sqrt{d}} = \cb{a + b\sqrt{d} \mid a, b \in \Z}. $$
\item If $ d \equiv 1 \mod 4 $ then
$$ \OO_K = \cb{\tfrac{u + v\sqrt{d}}{2} \mid u, v \in \Z, \ u \equiv v \mod 2} \supsetneq \Z\sb{\sqrt{d}}. $$
In this case $ \OO_K $ is the $ \Z $-linear span of $ 1 $ and $ \tfrac{1 + \sqrt{d}}{2} $.
\end{enumerate}
\end{theorem}

\begin{example*}
\hfill
\begin{enumerate}
\item $ \Z\sb{i}, \Z\sb{\sqrt{-2}}, \Z\sb{\sqrt{2}}, \Z\sb{\sqrt{-5}} $.
\item $ \Z\sb{\omega}, \Z\sb{\tfrac{1 + \sqrt{5}}{2}} $.
\end{enumerate}
\end{example*}

\begin{proof}
Let $ \OO_K $ be the integral closure of $ \Z $ in $ \Q\rb{\sqrt{d}} = K $. Let $ x = a + b\sqrt{d} $ for $ a, b \in \Q $. Assume $ x $ is an algebraic integer. Let $ \overline{x} = a - b\sqrt{d} $. Then $ x, \overline{x} $ satisfy the same polynomial equation with $ \Z $ coefficients, so $ \overline{x} = a - b\sqrt{d} $ is also an algebraic integer.
\begin{itemize}
\item $ x\overline{x} = \rb{a + b\sqrt{d}}\rb{a - b\sqrt{d}} = a^2 - b^2d \in \Q $ is an algebraic integer, so $ a^2 - b^2d \in \Z $.
\item $ x - \overline{x} = 2b\sqrt{d} $, so $ 4b^2d \in \Z $ gives $ 2b \in \Z $, because $ d $ is square-free.
\item $ x + \overline{x} = 2a $, so $ 2a \in \Z $.
\end{itemize}
Let $ a = u / 2 $ and $ b = v / 2 $.
\begin{enumerate}
\item If $ d \equiv 2, 3 \mod 4 $,
$$ a^2 - b^2d = \dfrac{u^2 - v^2d}{4} \in \Z \qquad \implies \qquad 4 \mid u^2, v^2 \qquad \implies \qquad 2 \mid u, v \qquad \implies \qquad a, b \in \Z. $$
\item If $ d \equiv 1 \mod 4 $,
$$ a^2 - db^2 = \dfrac{u^2 - v^2d}{4} \in \Z \qquad \implies \qquad 4 \mid u^2 - dv^2 \qquad \implies \qquad u \equiv v \mod 2. $$
\end{enumerate}
\end{proof}

\lecture{13}{Friday}{08/02/19}

Lecture 13 is a problem class.

\pagebreak

\subsection{Traces and norms}

\lecture{14}{Monday}{11/02/19}

Let $ K / \Q $ be a quadratic field. The conjugate is
$$ \function{K}{K}{\alpha = a + b\sqrt{d}}{\overline{\alpha} = a - b\sqrt{d}}. $$
Then
$$ \function[Tr]{K}{\Q}{\alpha}{\alpha + \overline{\alpha}}, \qquad \function[Nm]{K}{\Q}{\alpha}{\alpha \cdot \overline{\alpha}}, $$
and $ Tr : \OO_K \to \Z $ and $ Nm : \OO_K \to \Z $. $ \OO_K $ is a free $ \Z $-module of rank $ 2 $. Goal is to discuss trace and norm for general number fields. Motivation is that $ \OO_K $ is a free $ \Z $-module of rank $ \deg\rb{K / \Q} $.

\begin{proposition}
\label{prop:embeddings}
Let $ F \subseteq \C $ be a subfield. Let $ K / F $ be a finite extension of degree $ n $. Then there exist exactly $ n $ embeddings $ \sigma : K \hookrightarrow \C $ such that $ \sigma \mid_F = id_F $.
\end{proposition}

\begin{proof}
Assume first that $ K = F\rb{x} $, where $ x $ is a root of a minimal polynomial $ P\rb{t} \in F\sb{t} $. $ P $ has degree $ n $, since $ x^n $ is an $ F $-linear combination of $ 1, \dots, x^{n - 1} $. $ P $ has $ n $ distinct roots in $ \C $. Let $ \alpha $ be a root of $ P\rb{t} $ in $ \C $. This determines
$$ \function[\sigma]{K}{\C}{x}{\sigma\rb{x} = \alpha}, $$
where $ \sigma \mid_F = id_F $. Conversely, if $ \sigma : K \hookrightarrow \C $ such that $ \sigma \mid_F = id_F $, $ \sigma\rb{P\rb{t}} = P\rb{t} $ and $ \sigma\rb{x} $ is some root of $ P\rb{t} $ in $ \C $. In general, use induction on $ \deg\rb{K / F} = n $.
\begin{itemize}
\item $ n = 1 $ is ok. $ K = F $, so only one embedding.
\item $ n > 1 $. Choose $ x \in K \setminus F $. $ K / F\rb{x} / F $, so apply induction hypothesis on $ \deg\rb{K / F\rb{x}} < \deg\rb{K / F} $.
$$ n = \deg\rb{K / F} = \deg\rb{K / F\rb{x}} \cdot \deg\rb{F\rb{x} / F} = k \cdot m. $$
Have $ m $ embeddings $ \tau : F\rb{x} \hookrightarrow \C $ such that $ \tau \mid_F = id_F $. By induction, have $ k $ embeddings $ \sigma : K \hookrightarrow \C $ such that $ \sigma \mid_{F\rb{x}} = \tau $. Overall, have $ n = k \cdot m $ embeddings $ K \hookrightarrow \C $ which are $ id_F $ on $ F $.
\end{itemize}
\end{proof}

\begin{notation*}
Let $ e\rb{K / F} $ denote the set of embeddings as in Proposition \ref{prop:embeddings}.
\end{notation*}

Let $ x \in K $. Think of
$$ \function{K}{K}{y}{x \cdot y} $$
as an $ F $-linear transformation on $ K $. Let $ char_{K / F}\rb{x} $ denote the characteristic polynomial of multiplication by $ x $ in $ K $. $ char_{K / F}\rb{x} \in F\sb{t} $ has degree $ n = \sb{K : F} $.

\begin{example*}
Let $ K / \Q $ be quadratic and $ x = \sqrt{d} $. Then
$$ a + b\sqrt{d} \mapsto x \cdot \rb{a + b\sqrt{d}} = a\sqrt{d} + bd. $$
If $ K \cong \Q^2 $, then
$$ x = \twobytwo{0}{d}{1}{0}, \qquad char_{K / \Q}\rb{x} = t^2 - d = \rb{t - \sqrt{d}}\rb{t + \sqrt{d}}. $$
\end{example*}

\begin{proposition}
Let $ K / F $ be a finite extension of degree $ n $. Then
$$ char_{K / F}\rb{x} = \prod_{\sigma \in e\rb{K / F}} \rb{t - \sigma\rb{x}} \in F\sb{t}, $$
for all $ x \in K $.
\end{proposition}

\pagebreak

\begin{proof}
First assume $ K = F\rb{x} $. Then the right hand side is just the minimal polynomial $ P\rb{t} \in F\sb{t} $ of $ x $. For any root $ \alpha $ of $ P\rb{t} $, $ char_{K / F}\rb{x}\rb{\alpha} = 0 $, since
$$ \function{K}{\C}{x}{\alpha} $$
has an $ F $-basis given by $ 1, \dots, \alpha^{n - 1} $, and multiplication by $ \alpha $ shifts this. Every root of $ P\rb{t} $ is also a root of $ char_{K / F}\rb{x} $, and they are both monic polynomials of degree $ n $, so $ P\rb{t} = char_{K / F}\rb{x} $. In general, $ K / F\rb{x} / F $. Choose a basis $ e_1, \dots, e_m $ of $ K $ over $ F\rb{x} $. For any $ i = 1, \dots, m $ multiplication by $ x $ leaves $ e_iF\rb{x} \subset K $ stable and has characteristic polynomial equal to
$$ \prod_{\sigma \in e\rb{F\rb{x} / F}} \rb{t - \sigma\rb{x}}, $$
where $ e_iF\rb{x} \subset K $ is an $ F $-vector subspace of dimension $ \deg\rb{F\rb{x} / F} $. Thus
$$ char_{K / F}\rb{x} = \prod_{\sigma \in e\rb{F\rb{x} / F}} \rb{t - \sigma\rb{x}}^m = \prod_{\sigma \in e\rb{F\rb{x} / F}} \rb{\prod_{\tau \in e\rb{K / F\rb{x}}, \ \tau_{F\rb{x}} = \sigma} \rb{t - \tau\rb{x}}}. $$
\end{proof}

\lecture{15}{Tuesday}{12/02/19}

\begin{definition}
$ Tr : K \to F $ is the trace of multiplication by $ x $ and $ Nm : K \to F $ is the determinant of multiplication by $ x $. These are coefficients of $ char_{K / F}\rb{x} $.
\end{definition}

\begin{theorem}
\label{thm:integralclosure}
Let $ R \subseteq F $ be an integrally closed domain. Let $ S $ be the integral closure of $ R $ in $ K $. Then if $ x \in S $, $ char_{K / F}\rb{x} \in R\sb{t} $.
\end{theorem}

\begin{corollary}
Let $ K, F, S, R $ as in Theorem \ref{thm:integralclosure}. We have $ Tr : S \to R $ and $ Nm : S \to R $.
\end{corollary}

\begin{example*}
Let $ K / \Q $ be quadratic. Then $ Tr : \OO_K \to \Z $ and $ Nm : \OO_K \to \Z $.
\end{example*}

\begin{proof}[Proof of Theorem \ref{thm:integralclosure}]
Let $ x \in S $. Is
$$ char_{K / F}\rb{x} = \prod_{\sigma \in e\rb{K / F}} \rb{t - \sigma\rb{x}} \in R\sb{t}? $$
Let $ L $ be the \textbf{composite} of extensions $ \sigma\rb{K} \subseteq \C $, the smallest field extension of $ F $ containing all $ \sigma\rb{K} $. Let $ T $ be the integral closure of $ R $ in $ L $.
$$
\begin{tikzcd}[row sep=small]
T \arrow[subset]{r} & L \\
S \arrow[hookrightarrow]{u} \arrow[subset]{r} & K \arrow[hookrightarrow]{u} \\
R \arrow[hookrightarrow]{u} \arrow[subset]{r} & F \arrow[hookrightarrow]{u}
\end{tikzcd}.
$$
For all $ \sigma \in e\rb{K / F} $, $ \sigma\rb{x} $ is a root of the minimal polynomial $ P\rb{t} \in F\sb{t} $ of $ x $ over $ F $, and $ x \in S $ gives $ P\rb{t} \in R\sb{t} $, so $ \sigma\rb{x} \in T $. The coefficients of $ char_{K / F}\rb{x} $ are symmetric polynomials in the $ \sigma\rb{x} $,
$$ \sum_{\sigma \in e\rb{K / F}} \sigma\rb{x}, \sum_{\sigma, \sigma' \in e\rb{K / F}} \sigma\rb{x}\sigma'\rb{x}, \dots \in T, $$
therefore they are elements of $ T $. Upshot is that $ char_{K / F}\rb{x} \in \rb{F \cap T}\sb{t} = R\sb{t} $, since $ F \cap T $ is the integral closure of $ R $ in $ F $, which is $ R $.
\end{proof}

\begin{corollary}
If $ K / \Q $ is a finite extension, so $ F = \Q $, and $ \OO_K \subset K $ is the ring of integers, so $ R = \Z $. Then $ Tr : \OO_K \to \Z $ and $ Nm : \OO_K \to \Z $.
\end{corollary}

\pagebreak

\subsection{Bilinear forms}

\begin{definition}
Let $ V $ be a finite dimensional $ \Q $-vector space. A function
$$ \function[\ab{,}]{V \times V}{\Q}{\rb{v, w}}{\ab{v, w}} $$
is
\begin{itemize}
\item \textbf{$ \Q $-bilinear} if it is $ \Q $-linear as a function of $ v $ and $ \Q $-linear as a function of $ w $,
\item \textbf{symmetric} if $ \ab{v, w} = \ab{w, v} $, and
\item \textbf{non-degenerate} if for all $ v \in V $ such that $ v \ne 0 $, there exists $ w \in V $ such that $ \ab{v, w} \ne 0 $.
\end{itemize}
\end{definition}

\begin{example*}
\hfill
\begin{itemize}
\item Let $ V = \Q $.
$$ \function{V \times V}{\Q}{\rb{v, w}}{0} $$
is symmetric and bilinear.
\item Let $ V = \Q^2 $.
$$ \function{V \times V}{\Q}{\rb{v, w}}{\ab{v, w} = v \cdot w = v\twobytwo{1}{0}{0}{1}w^t} $$
is the inner product, which is non-degenerate.
\item Let $ K / \Q $ be quadratic.
$$ \function[Tr_{K / \Q}\rb{,}]{K \times K}{\Q}{\rb{x, y}}{Tr_{K / \Q}\rb{x \cdot y} \in \Q} $$
is
\begin{itemize}
\item symmetric, because $ x \cdot y = y \cdot x $, that is multiplication in $ K $ is commutative,
\item non-degenerate, because for all $ x \in K^\times $, take $ y = x^{-1} $,
$$ Tr_{K / \Q}\rb{x, y} = Tr_{K / \Q}\rb{xx^{-1}} = Tr_{K / \Q}\rb{1} = 2 \ne 0, $$
\item bilinear, because $ Tr_{K / \Q} $ is $ \Q $-linear.
\end{itemize}
\item Let $ K = \Q\rb{i} $, $ x = a + bi $, and $ y = c + di $.
$$ Tr_{\Q\rb{i} / \Q}\rb{x, y} = Tr_{\Q\rb{i} / \Q}\rb{\rb{a + bi}\rb{c + di}} = Tr_{\Q\rb{i} / \Q}\rb{ac - bd + ibc + iad} = 2\rb{ac - bd}, $$
so $ x, y \in \Z\sb{i} $ gives $ Tr_{\Q\rb{i} / \Q}\rb{x, y} \in \Z $.
\end{itemize}
\end{example*}

\pagebreak

\subsection{Lattices}

\lecture{16}{Friday}{15/02/19}

\begin{definition}
Let $ V $ be a finite dimensional $ \Q $-vector space. A \textbf{free $ \Z $-lattice}, or \textbf{lattice}, in $ V $ is a $ \Z $-submodule $ M \subseteq V $ that is free of rank $ \dim_\Q\rb{V} $.
\end{definition}

\begin{example*}
\hfill
\begin{itemize}
\item $ \Q\rb{\sqrt{-3}} \supset \Z\sb{\sqrt{-3}}, \Z\sb{2\sqrt{-3}}, \Z\sb{\omega / 2} $ are lattices.
\item $ \Z, \sqrt{-3}\Z $ are not lattices.
\end{itemize}
\end{example*}

\begin{lemma}
Let $ M \subseteq V $ be a lattice. If $ e_1, \dots, e_n $ is a $ \Z $-basis for $ M $ then $ e_1, \dots, e_n $ is a $ \Q $-basis for $ V $.
\end{lemma}

\begin{proof}
Notice that $ \dim_\Q\rb{V} = n $, since $ rk_\Z\rb{M} = n $. If $ e_1, \dots, e_n $ are $ \Q $-linearly independent then $ e_1, \dots, e_n $ generate $ W \subseteq V $ with $ \dim_\Q\rb{W} = n = \dim_\Q\rb{V} $, so $ W = V $. Assume there exist $ a_1, \dots, a_n \in \Q $ such that
$$ a_1e_1 + \dots + a_ne_n = 0. $$
Multiply this equation by the product of the denominators of the $ a_i $, which is not zero,
$$ a_1'e_1 + \dots + a_n'e_n = 0, $$
where $ a_1', \dots, a_n' \in \Z $, so $ a_1' = \dots = a_n' = 0 $. Thus $ a_1 = \dots = a_n = 0 $.
\end{proof}

Let $ M \subseteq V / \Q $ be a lattice. Let $ \ab{,} $ be a non-degenerate symmetric bilinear form on $ V $. Define
$$ M^V = \cb{w \in V \mid \ab{v, w} \in \Z \ \text{for all} \ v \in M}. $$

\begin{proposition}
\label{prop:duallattice}
$ M^V \subseteq V $ is also a lattice.
\end{proposition}

\begin{example*}
Let $ K = \Q\rb{\sqrt{-3}} $, $ Tr_{K / \Q}\rb{,} $, and $ M = \Z\sb{\sqrt{-3}} $. Then
$$ Tr_{K / \Q}\rb{a + b\sqrt{-3}, c + d\sqrt{-3}} = Tr_{K / \Q}\rb{ac - 3bd + \sqrt{-3}\rb{ad + bc}} = 2\rb{ac - 3bd}. $$
\begin{itemize}
\item $ \ab{1, c + d\sqrt{-3}} = 2c \in \Z $.
\item $ \ab{\sqrt{-3}, c + d\sqrt{-3}} = -6d \in \Z $.
\end{itemize}
Thus
$$ M^V = \cb{c + d\sqrt{-3} \mid c \in \tfrac{1}{2}\Z, \ d \in \tfrac{1}{6}\Z} = \ab{\tfrac{1}{2}, \tfrac{\sqrt{-3}}{6}} \supseteq \Z\sb{\omega} \supseteq M. $$
$ 1^V = 1 / 2 $ and $ \rb{\sqrt{-3}}^V = \sqrt{-3} / 6 $.
\end{example*}

\begin{proof}
Want that $ M^V \subseteq V $ is a lattice. Let $ e_1, \dots, e_n $ be a $ \Z $-basis of $ M $, so a $ \Q $-basis of $ V $. Given $ \ab{,} : V \times V \to \Q $ define $ e_1^V, \dots, e_n^V $ to be the dual basis to $ e_1, \dots, e_n $,
$$ \ab{e_i, e_j^V} =
\begin{cases}
1 & i = j \\
0 & i \ne j
\end{cases}.
$$
Claim that $ e_1^V, \dots, e_n^V $ is a $ \Z $-basis for $ M^V $.
\begin{itemize}
\item $ e_1^V, \dots, e_n^V $ are $ \Z $-linearly independent because $ \Q $-linearly independent.
$$ w = a_1e_1^V + \dots + a_ne_n^V = 0, $$
where $ a_i \in \Z \subseteq \Q $, so $ a_i = \ab{e_i, w} = 0 $.
\item $ e_i^V \in M^V $, by using definition of $ M^V $. Want $ \ab{v, e_i^V} \in \Z $ for all $ v \in M $. $ v \in M $ gives
$$ v = b_1e_1 + \dots + b_ne_n, $$
where $ b_i \in \Z $, so $ \ab{v, e_i^V} = b_i \in \Z $.
\item For all $ w \in M^V \subseteq V $,
$$ w = c_1e_1^V + \dots + c_ne_n^V, $$
where $ c_i \in \Z $. Can do this with $ c_i \in \Q $ for $ i = 1, \dots, n $. Need to show they are in $ \Z $. Have $ \ab{e_i, w} = c_i $ and $ w \in M^V $, so $ c_i \in \Z $.
\end{itemize}
\end{proof}

\pagebreak

\subsection{$ \OO_K $ is a lattice}

\begin{theorem}
Let $ K / \Q $ be a number field of degree $ n $, with ring of integers $ \OO_K $. Then $ \OO_K $ is a lattice in $ K $.
\end{theorem}

\begin{proof}
Idea is
\begin{enumerate}
\item find lattice $ M \subseteq \OO_K $, and
\item show $ M^V \supseteq \OO_K $, the dual with respect to $ Tr_{K / \Q}\rb{,} $.
\end{enumerate}
By structure theorem,
$$ M^V \supseteq \OO_K \supseteq M, $$
so
$$ rk\rb{M} \le rk\rb{\OO_K} \le rk\rb{M^V}. $$
\begin{enumerate}
\item We can find $ n $ $ \Q $-linearly independent algebraic numbers $ e_1, \dots, e_n \in K $, because $ \dim_\Q\rb{K} = n $, so any $ \Q $-basis of $ K $ will work. $ e_i $ is an algebraic number, but may not be an algebraic integer.
$$ e_i^n + \alpha_1e_i^{n - 1} + \dots + \alpha_{n - 1} = 0, $$
for $ \alpha_1, \dots, \alpha_{n - 1} \in \Q $. Multiply equation by $ n $-th power $ A^n $ of denominators of $ \alpha_i $. Let $ e_i' = Ae_i $, so
$$ \rb{Ae_i}^n + \rb{A\alpha_1}\rb{Ae_i}^{n - 1} + \dots + \rb{A^n\alpha_{n - 1}} = 0, $$
for $ A\alpha_1, \dots, A^n\alpha_{n - 1} \in \Z $. Can assume $ e_i \in \OO_K $, that is algebraic integers. Let $ M \subseteq \OO_K $ be the $ \Z $-span of $ e_1, \dots, e_n $.
\item $ M^V \subseteq K $ is a lattice by Proposition \ref{prop:duallattice}. Show that $ \alpha \in \OO_K \subseteq M^V $. For all $ \beta \in M $, $ Tr_{K / \Q}\rb{\beta, \alpha} = Tr_{K / \Q}\rb{\alpha \cdot \beta} \in \Z $, since we know $ \alpha \cdot \beta \in \OO_K $ and $ Tr_{K / \Q} \mid_{\OO_K} : \OO_K \to \Z \subset \Q $.
\end{enumerate}
\end{proof}

\pagebreak

\section{Dedekind domains}

\lecture{17}{Monday}{18/02/19}

Goal is to discuss Dedekind domains. A number field $ K / \Q $ gives the ring of integers $ \OO_K $, which is not usually a UFD.
\begin{itemize}
\item We will show that unique factorisation of ideals holds in Dedekind domains and $ \OO_K $ is a Dedekind domain.
\item We will introduce the ideal class group, which measures how far $ \OO_K $ is from being a PID or UFD.
\end{itemize}

\subsection{Dedekind domains}

Recall that $ \mm \subsetneq R $ is a maximal ideal if for all $ \mm \subseteq \nn \subseteq R $ either $ \nn = \mm $ or $ \nn = R $.

\begin{definition}
A ring $ R $ is called a \textbf{Dedekind domain} if $ R $ is an integrally closed Noetherian domain and every non-zero proper prime ideal of $ R $ is a maximal ideal.
\end{definition}

\begin{proposition}
\label{prop:dedekinddomain}
If $ R $ is a PID, then $ R $ is a Dedekind domain.
\end{proposition}

\begin{lemma}
\label{lem:dedekinddomain}
An element $ a \in R \setminus \cb{0} $ is irreducible if and only if $ \ab{a} $ is a maximal ideal among principal ideals.
\end{lemma}

\begin{proof}
$ a = bc $ is irreducible if and only if
$$
\begin{cases}
b \in R^\times, \ a \mid c \\
c \in R^\times, \ a \mid b
\end{cases}
\qquad \iff \qquad
\begin{cases}
\ab{b} = R, \ \ab{c} = \ab{a} \\
\ab{c} = R, \ \ab{b} = \ab{a}
\end{cases}.
$$
\begin{itemize}
\item[$ \implies $] Assume $ \ab{a} \subseteq \ab{b} \subseteq R $. $ b \mid a $ gives $ b \in R^\times $, so $ \ab{b} = R $, or $ a \mid b $, so $ \ab{b} = \ab{a} $. Thus $ a $ is irreducible.
\item[$ \impliedby $] Assume $ a = bc $. $ b \mid a $ gives $ R \supseteq \ab{b} \supseteq \ab{a} $, so either $ \ab{b} = R $ if and only if $ b \in R^\times $, or $ \ab{b} = \ab{a} $ if and only if $ a \mid b $ and $ c \in R^\times $.
\end{itemize}
\end{proof}

\begin{proof}[Proof of Proposition \ref{prop:dedekinddomain}]
$ R $ is a PID gives $ R $ is an integrally closed Noetherian domain. Let $ a \in R \setminus \cb{0} $ be such that $ \ab{a} $ is prime, if and only if $ a $ is prime, so $ a $ is irreducible. Lemma \ref{lem:dedekinddomain} gives that $ \ab{a} $ is maximal.
\end{proof}

\begin{example*}
\hfill
\begin{itemize}
\item $ \Z, \Z\sb{i}, \Z\sb{\sqrt{2}}, \Z\sb{\omega} $ are PIDs.
\item $ \Z\sb{\sqrt{-3}} $ is not a Dedekind domain because it is not integrally closed.
\item $ \Z\sb{\sqrt{-5}}, \Q\sb{x} $ are Dedekind domains.
\item $ \Z\sb{x} $ is not a Dedekind domain, since $ 0 \subsetneq \ab{x} \subsetneq \ab{2, x} $ are prime but $ \ab{x} $ is not zero or maximal.
\end{itemize}
\end{example*}

\subsection{Ideal norms}

\begin{definition}
Let $ K $ be a number field, with ring of integers $ \OO_K $ and a prime ideal $ 0 \ne \nn \subseteq \OO_K $. Then $ \OO_K / \nn $ is finite and define $ Nm\rb{\nn} = \#\OO_K / \nn $.
\end{definition}

If $ 0 \ne a \in \nn \cap \Z $, then $ \nn \supseteq \ab{a} $ and
$$ \dfrac{\OO_K}{\ab{a}} = \rb{\dfrac{\Z}{a\Z}}^{\deg\rb{K / \Q}} $$
is finite, so $ \OO_K / \ab{a} \twoheadrightarrow \OO_K / \nn $ and
$$ \#\dfrac{\OO_K}{\nn} \le \#\dfrac{\OO_K}{\ab{a}} $$
is finite.

\pagebreak

\begin{example*}
\hfill
\begin{itemize}
\item Let $ \ab{p} \subsetneq \Z $ for $ p $ prime. Then
$$ Nm\rb{\ab{p}} = \#\dfrac{\Z}{\ab{p}} = \#\dfrac{\Z}{p\Z} = p. $$
\item Let $ a \in \Z \hookrightarrow \OO_K $. Then
$$ Nm\rb{\ab{a}} = \#\dfrac{\OO_K}{\ab{a}} = a^{\deg\rb{K / \Q}} = Nm_{K / \Q}\rb{a}. $$
If $ x \in \OO_K $, then $ Nm\rb{\ab{x}} = Nm_{K / \Q}\rb{x} $.
\item Let $ \OO_K = \Z\sb{\sqrt{-5}} \supsetneq \ab{2, 1 + \sqrt{-5}} $. Then $ Nm\rb{\ab{2, 1 + \sqrt{-5}}} = 2 $.
\begin{itemize}
\item
$$ \dfrac{\OO_K}{\ab{2, 1 + \sqrt{-5}}} = \dfrac{\Z\sb{x}}{\ab{x^2 + 5, 2, 1 + x}} = \dfrac{\Z}{2\Z}, $$
\item Alternatively, use structure theorem of finitely generated abelian groups. Have $ \rb{e_1, e_2} $ a basis for $ \OO_K $ over $ \Z $ and $ a_1, a_2 \in \Z \setminus \cb{0} $ such that $ a_1 \mid a_2 $ and $ \rb{a_1e_1, a_2e_2} $ a basis for $ \ab{2, 1 + \sqrt{-5}} $.
\begin{itemize}
\item $ \OO_K $ is generated by $ 1 + \sqrt{-5}, 1 $, and
\item $ \ab{2, 1 + \sqrt{-5}} $ is generated by $ 1 + \sqrt{-5}, 2 $,
\end{itemize}
so $ a_1 = 1 $ and $ a_2 = 2 $. Thus $ Nm\rb{\ab{2, 1 + \sqrt{-5}}} = a_1 \cdot a_2 $.
\item Alternatively, in the standard basis of $ \OO_K $, where $ e_1 = 1 $ and $ e_2 = \sqrt{-5} $,
$$ \ab{2, 1 + \sqrt{-5}} = \twobytwo{2}{0}{1}{1} \cdot \OO_K. $$
Then
$$ Nm\rb{\ab{2, 1 + \sqrt{-5}}} = \abs{\det\twobytwo{2}{0}{1}{1}} $$
is the absolute value of the determinant.
\end{itemize}
\end{itemize}
\end{example*}

\lecture{18}{Tuesday}{19/02/19}

\begin{remark*}
$ Nm\rb{\nn} \in \nn $ because $ Nm\rb{\nn} $ in $ \OO_K / \nn $ is equal to zero, because the order of a finite group is always equal to zero in that finite group.
\end{remark*}

\subsection{$ \OO_K $ is a Dedekind domain}

Goal is to show that $ \OO_K $ is a Dedekind domain, that is it is an integrally closed Noetherian domain and non-zero prime ideals are maximal ideals. It is an integrally closed domain.

\begin{proposition}
The ring of integers $ \OO_K $ in a number field $ K $ is Noetherian.
\end{proposition}

\begin{proof}
Assume that
$$ \aa_1 \subseteq \dots \subseteq \aa_n \subseteq \dots $$
is an ascending sequence of ideals in $ \OO_K $.
$$ Nm\rb{\aa_1} \ge \dots \ge Nm\rb{\aa_n} \ge \dots, $$
since
$$ \OO_K / \aa_1 \twoheadrightarrow \dots \twoheadrightarrow \OO_K / \aa_n \twoheadrightarrow \dots. $$
This must stabilise, so
$$ Nm\rb{\aa_n} = Nm\rb{\aa_{n + 1}} = \dots. $$
$ \aa_n \subseteq \aa_{n + 1} $ gives $ \OO_K / \aa_n \twoheadrightarrow \OO_K / \aa_{n + 1} $. Equality of norms gives that this must be a bijection, so $ \aa_n = \aa_{n + 1} $. (Exercise: $ \aa \subseteq \bb \subseteq \OO_K $ such that $ Nm\rb{\aa} = Nm\rb{\bb} $ gives $ \aa = \bb $)
\end{proof}

\pagebreak

\begin{lemma}
Let $ R $ be an integral domain which is also a finite set. Then $ R $ is a field.
\end{lemma}

\begin{proof}
Let $ x \in R \setminus \cb{0} $. Look at $ x, x^2, \dots $. Since $ R $ is finite, we must have $ x^n = x^m $ for some $ n, m \in \Z_{\ge 1} $. If $ n > m $ then $ x^{n - m} = 1 $, so $ x \in R^\times $. Thus $ R $ is a field. Alternatively,
$$ \function{R}{R}{y}{x \cdot y} $$
is injective because $ R $ is an integral domain and bijective because $ R $ is a finite set.
\end{proof}

\begin{lemma}
Let $ \pp $ be a prime ideal in $ \OO_K $. Then $ \pp $ must be a maximal ideal.
\end{lemma}

\begin{proof}
$ \OO_K / \pp $ is an integral domain and a finite set of cardinality $ Nm\rb{\pp} $.
\end{proof}

\begin{remark*}
Let $ \pp \ne 0 $ be a prime ideal of $ \OO_K $. Then $ Nm\rb{\pp} = p^r $ for some $ p \in \Z $ prime and $ r \in \Z_{\ge 1} $ because of the classification of finite fields.
\end{remark*}

\begin{remark*}
$$
\begin{tikzcd}[row sep=tiny, column sep=tiny]
& & \cb{\text{UFDs}} \arrow[subset]{dr} & & & \\
\dots \arrow[subset]{r} & \cb{\text{PIDs}} \arrow[subset]{ur} \arrow[subset]{dr} & \ne & \cb{\text{integrally closed domains}} \arrow[subset]{r} & \cb{\text{IDs}} \arrow[subset]{r} & \dots \\
& & \cb{\text{Dedekind domains}} \arrow[subset]{ur} & & &
\end{tikzcd}.
$$
\begin{itemize}
\item $ \Z\sb{\sqrt{-5}} $ is a Dedekind domain but not a UFD.
\item $ \Z\sb{x} $ is a UFD but not a Dedekind domain.
\end{itemize}
\end{remark*}

\subsection{Properties of ideal norms}

\begin{proposition}
Let $ I \subseteq J \subseteq \OO_K $ be a sequence of ideals. Then $ Nm\rb{J} \mid Nm\rb{I} $.
\end{proposition}

\begin{proof}
Let $ \phi : \OO_K / I \twoheadrightarrow \OO_K / J $ be a ring homomorphism. Then
$$ \dfrac{\dfrac{\OO_K}{I}}{Ker\rb{\phi}} \cong \dfrac{\OO_K}{J}, $$
so
$$ Nm\rb{I} = Nm\rb{J} \cdot \#Ker\rb{\phi}. $$
Thus $ Nm\rb{J} \mid Nm\rb{I} $.
\end{proof}

\begin{example*}
Show that the ideals $ I = \ab{11, 3 + \sqrt{31}} $ and $ J = \ab{6, 1 + \sqrt{31}} $ in $ \Z\sb{\sqrt{31}} $ are relatively prime, that is $ I + J = \Z\sb{\sqrt{31}} $, if and only if $ Nm\rb{I + J} = 1 $.
$$ Nm\rb{I} = \abs{\det\twobytwo{11}{0}{3}{1}} = 11, \qquad Nm\rb{I} = \abs{\det\twobytwo{6}{0}{1}{1}} = 6. $$
$ I \subset I + J $, so $ Nm\rb{I + J} \mid Nm\rb{I} = 11 $, and $ J \subset I + J $, so $ Nm\rb{I + J} \mid Nm\rb{J} = 6 $. Thus $ Nm\rb{I + J} = 1 $.
\end{example*}

Let $ a \in \OO_K $. Structure theorem of finite generated abelian groups gives that if $ e_1, \dots, e_n $ is a basis for $ \OO_K $, where $ n = \deg\rb{K / \Q} $, then $ a_1e_1, \dots, a_ne_n $ is a basis for $ \ab{a} $. Then
$$ \dfrac{\OO_K}{\ab{a}} = \dfrac{\Z}{a_1\Z} \times \dots \times \dfrac{\Z}{a_n\Z}, $$
so
$$ Nm\rb{\ab{a}} = a_1 \cdot \dots \cdot a_n = \det\rb{a} = Nm_{K / \Q}\rb{a}. $$

\lecture{19}{Friday}{22/02/19}

Lecture 19 is a problem class.

\pagebreak

\subsection{Fractional ideals}

\lecture{20}{Monday}{25/02/19}

Goal is to show that unique factorisation of ideals into prime ideals always holds in a Dedekind domain.

\begin{definition}
Let $ R $ be an integral domain, with fraction field $ K $. A \textbf{fractional ideal} $ \nn $ of $ R $ is an $ R $-submodule of $ K $, that is
\begin{itemize}
\item an additive subgroup, so $ x \in \nn $ and $ y \in \nn $ gives $ x + y \in \nn $, and
\item stable under multiplication by $ R $, so $ x \in \nn $ and $ r \in R $ gives $ rx \in \nn $,
\end{itemize}
such that there exists $ a \in R $ such that $ a\nn = \cb{ax \mid x \in \nn} \subseteq R $.
\end{definition}

\begin{example*}
\hfill
\begin{itemize}
\item Any ideal of $ R $ is also a fractional ideal with $ a = 1 $. Conversely, if $ \nn $ is a fractional ideal and $ \nn \subseteq R $, then $ \nn $ is an integral ideal.
\item Let $ R = \Z \hookrightarrow \Q $. Then the fractional ideals of $ \Q $ are $ \tfrac{p}{q} \cdot \Z $ for $ p, q \in \Z $ and $ q \ne 0 $. $ \Q $ is not a fractional ideal, but it is a $ \Z $-module.
\end{itemize}
\end{example*}

We can multiply fractional ideals of $ R $ by
$$ \mm \cdot \nn = \cb{\sum_{i = 1}^k x_i \cdot y_i \ \Bigg| \ x_i \in \mm, \ y_i \in \nn, \ k \in \Z_{\ge 0}}. $$

\begin{lemma}
If $ \mm, \nn $ are fractional ideals of $ R $ then $ \mm \cdot \nn $ is also a fractional ideal of $ R $.
\end{lemma}

\begin{proof}
$ \mm \cdot \nn $ is additive. $ \mm \cdot \nn $ is stable under multiplication by $ r \in R $, since
$$ r\rb{\sum_{i = 1}^k x_i \cdot y_i} = \sum_{i = 1}^k rx_i \cdot y_i \in \mm \cdot \nn. $$
There exists $ a, b \in R $ such that $ a\mm \subseteq R $ and $ b\nn \subseteq R $, so $ ab \cdot \mm \cdot \nn \subseteq R $.
\end{proof}

Multiplication of fractional ideals is commutative, so $ \mm \cdot \nn = \nn \cdot \mm $, is associative, and has unit $ R \cdot \mm = \mm \cdot R = \mm $. If $ R $ is a Dedekind domain, we will show that every fractional ideal has a multiplicative inverse, that is given a fractional ideal $ \mm $ of $ R $, there exists a fractional ideal $ \mm^{-1} $ of $ R $ such that $ \mm \cdot \mm^{-1} = R $.

\begin{example*}
$ \Z\sb{x} $ is not a Dedekind domain, since $ \ab{2, x} $ does not have an inverse with respect to multiplication.
\end{example*}

\begin{theorem}
\label{thm:group}
Let $ R $ be a Dedekind domain. The set of non-zero fractional ideals of $ R $ forms a commutative group under multiplication.
\end{theorem}

To prove Theorem \ref{thm:group}, need some preliminary results.

\begin{lemma}
\label{lem:primeideal}
Let $ \pp \subsetneq R $ be a prime ideal in an integral domain. Assume $ \pp \supseteq \aa_1\aa_2 $ for ideals $ \aa_1, \aa_2 \subseteq R $. Then $ \pp \supseteq \aa_1 $ or $ \pp \supseteq \aa_2 $.
\end{lemma}

\begin{proof}
If $ \pp \nsupseteq \aa_1 $ there exists $ x \in \aa_1 \setminus \pp $, so $ x\aa_2 \subseteq \pp $. Let $ y \in \aa_2 $. Then $ xy \in \pp $ and $ x \notin \pp $ gives $ y \in \pp $, since $ \pp $ is prime, so $ \aa_2 \subseteq \pp $.
\end{proof}

\begin{remark*}
Same Lemma \ref{lem:primeideal} holds if $ \pp \supseteq \aa_1, \dots, \aa_n $ for $ n \in \Z_{\ge 1} $ then $ \pp \supseteq \aa_i $ for some $ i $.
\end{remark*}

\begin{lemma}
\label{lem:primeproduct}
If $ I \subseteq R $ is a non-zero ideal of a Noetherian domain, there exists $ \pp_1, \dots, \pp_n \subseteq R $ non-zero prime ideals not necessarily distinct, such that $ I \supseteq \pp_1 \dots \pp_n $ for some finite $ n \in \Z $.
\end{lemma}

\pagebreak

\begin{proof}
Assume Lemma \ref{lem:primeproduct} is false. Choose $ I $ for which condition in Lemma \ref{lem:primeproduct} fails and such that $ I $ is maximal with respect to inclusion, that is for all $ J \supseteq I $, $ J $ satisfies the condition. $ I $ is not prime, otherwise it would satisfy the condition. There exists $ a, b \in R $ such that $ a \notin I $ and $ b \notin I $ but $ ab \in I $. Look at $ I \subsetneq I + bR $ and $ I \subsetneq I + aR $, both satisfying the condition. Let $ I + bR \supseteq \pp_1 \dots \pp_r $ and $ I + aR \supseteq \qq_1 \dots \qq_s $.
Thus
$$ \pp_1 \dots \pp_r \cdot \qq_1 \dots \qq_s \subseteq \rb{I + bR} \cdot \rb{I + aR} \subseteq I. $$
\end{proof}

\begin{proposition}
\label{prop:inverse}
Let $ R $ be a Dedekind domain. Let $ \mm \subsetneq R $ be a non-zero prime ideal, if and only if maximal ideal of $ R $. Define
$$ \mm^{-1} = \cb{a \in K \mid a\mm \subseteq R}. $$
Then $ \mm^{-1} $ is a fractional ideal of $ R $ and $ \mm \cdot \mm^{-1} = R $.
\end{proposition}

\lecture{21}{Tuesday}{26/02/19}

\begin{proof}
$ \mm^{-1} $ is a fractional ideal.
\begin{itemize}
\item $ \mm^{-1} $ is an additive subgroup of $ K $.
$$
\begin{cases}
x \in \mm^{-1} \quad \implies \quad x \cdot \mm \subseteq R \\
y \in \mm^{-1} \quad \implies \quad y \cdot \mm \subseteq R
\end{cases}
\quad \implies \quad \rb{x + y}\mm \subseteq x\mm + y\mm \subseteq R \quad \implies \quad x + y \in \mm^{-1}.
$$
\item $ \mm^{-1} $ is stable under multiplication by $ R $.
$$ x \in \mm^{-1} \qquad \implies \qquad x \cdot \mm \subseteq R \qquad \implies \qquad rx \cdot \mm \subseteq R \qquad \implies \qquad rx \in \mm^{-1}. $$
\item Let $ a \in \mm $ such that $ a \ne 0 $. Then $ a\mm^{-1} \subseteq R $ by definition of $ \mm^{-1} $.
\end{itemize}
$ \mm = \mm \cdot 1 \subseteq \mm \cdot \mm^{-1} \subseteq R $ is automatic by definition. Since $ \mm $ is maximal, either $ \mm = \mm \cdot \mm^{-1} $ or $ \mm \cdot \mm^{-1} = R $. Assume $ \mm = \mm \cdot \mm^{-1} $ and get a contradiction. Take $ x \in \mm^{-1} $.
$$ \dots \subseteq x^n \cdot \mm \subseteq \dots \subseteq x \cdot \mm \subseteq \mm \subsetneq R, $$
so $ x^n \in \mm^{-1} $ for all $ n \in \Z_{\ge 1} $. Let $ R\sb{x} $ be the subring of $ K $ generated by $ x $, so $ R\sb{x} \subseteq \mm^{-1} $. Let $ a \in R \setminus \cb{0} $ be such that $ a\mm^{-1} \subseteq R $. In particular $ aR\sb{x} \subseteq R $ is an integral ideal of $ R $. $ R $ is Noetherian, so $ aR\sb{x} $ is generated over $ R $ by finitely many elements $ y_1, \dots, y_k \in R $. $ x \cdot y_i \in aR\sb{x} $ gives
$$ x \cdot \threebyone{y_1}{\vdots}{y_k} = A\threebyone{y_1}{\vdots}{y_k}, \qquad A = \threebythree{a_{11}}{\dots}{a_{1k}}{\vdots}{\ddots}{\vdots}{a_{k1}}{\dots}{a_{kk}} \in M_k\rb{R}, $$
a $ k \times k $ matrix, so $ x $ is an eigenvalue of $ A $ with eigenvector $ \rb{y_1, \dots, y_k}^t $. Thus $ x $ is a root of $ \det\rb{tI_k - A} $, so $ x $ is integral over $ R $. All $ x \in \mm^{-1} $ satisfy $ x \in R $ because $ R $ is integrally closed, so $ \mm^{-1} = R $. Choose $ a \in \mm \setminus \cb{0} $. Then
$$ \mm \supsetneq \ab{a} \supseteq \pp_1 \cdot \dots \cdot \pp_k, $$
where $ \pp_i $ are prime, by Lemma \ref{lem:primeproduct}. Lemma \ref{lem:primeideal} from last time gives that $ \mm $ must contain $ \pp_i $ for some $ i = 1, \dots, k $. Assume $ \mm \supseteq \pp_1 \ne 0 $, so $ \mm = \pp_1 $. Choose $ k $ such that it is minimal among all possible $ \pp_1 \cdot \dots \cdot \pp_k $ contained in $ \ab{a} $, so $ \pp_2 \cdot \dots \cdot \pp_k \nsubseteq \ab{a} $, since $ \pp_2 \cdot \dots \cdot \pp_k $ has length $ k - 1 $. Choose $ 0 \ne b \in \pp_2 \cdot \dots \pp_k \setminus \ab{a} $. Then $ b / a \in K $ such that
\begin{enumerate}
\item $ b / a \in R $, and
\item $ b / a \in \mm^{-1} $
\end{enumerate}
gives a contradiction.
\begin{enumerate}
\item $ b \in aR = \ab{a} $ is false, so $ b / a \notin R $.
\item $ b / a \in \mm^{-1} $ if $ b / a \cdot \mm \subseteq R $, or equivalently
$$ b \cdot \mm \in \pp_1 \cdot \dots \cdot \pp_k \subseteq \ab{a}. $$
\end{enumerate}
$ \mm^{-1} \ne R $ gives $ \mm \cdot \mm^{-1} \ne R $, so $ \mm \cdot \mm^{-1} = R $, which is done.
\end{proof}

\pagebreak

\subsection{Unique factorisation of ideals}

\begin{theorem}[Unique factorisation of ideals]
\label{thm:uniquefactorisationofideals}
\hfill
\begin{enumerate}
\item Any non-zero fractional ideal $ I $ of $ R $ can be written as
$$ I = \pp_1^{k_1} \cdot \dots \cdot \pp_r^{k_r}, $$
where $ \pp_1 $ are non-zero prime ideals and $ k_i \in \Z \setminus \cb{0} $.
\item This factorisation is unique up to order of the $ \pp_i $.
\end{enumerate}
\end{theorem}

\begin{remark*}
Given $ I $,
$$ I^{-1} = \pp_1^{-k_1} \cdot \dots \cdot \pp_r^{-k_r}. $$
Get $ I \cdot I^{-1} = R $, so any non-zero fractional ideal has a multiplicative inverse.
\end{remark*}

\begin{proof}
\hfill
\begin{enumerate}
\item There exists $ a \in R \setminus \cb{0} $ such that $ aI \subseteq R $ is an integral ideal so we may assume $ I $ is an integral ideal. Assume Theorem \ref{thm:uniquefactorisationofideals} is false. Because $ R $ is Noetherian, there exists $ I $ such that $ I $ does not admit a factorisation and $ I $ is maximal with this property. Let $ \mm \supseteq I $ be a maximal ideal. Then $ J = \mm^{-1} \cdot I \subseteq R $, so $ J $ is an integral ideal. $ J $ admits a factorisation because
$$ \mm^{-1} \cdot I = J \supsetneq I = 1 \cdot I, $$
since if $ \mm^{-1} \cdot I = I $, argue as in proof of Proposition \ref{prop:inverse}. Thus $ I = \mm \cdot J $, a contradiction.
\item Let
$$ \pp_1^{k_1} \cdot \dots \cdot \pp_r^{k_r} = \qq_1^{k_1} \cdot \dots \cdot \qq_r^{k_r}. $$
We may assume all $ k_i, l_j > 0 $. $ \pp_1 \supseteq \qq_1^{l_1} \cdot \dots \cdot \qq_s^{l_s} $, so $ \pp_1 \supseteq \qq_1 $. Both maximal, so $ \pp_1 = \qq_1 $.
\end{enumerate}
\end{proof}

\lecture{22}{Friday}{01/03/19}

\subsection{Ideal class groups}

\begin{definition}
Let $ R $ be a Dedekind domain. The \textbf{ideal class group} of $ R $ is the quotient of the group of all non-zero fractional ideals by the subgroup of principal fractional ideals. This is denoted by $ Cl\rb{R} $.
\end{definition}

If $ K $ is a number field, then $ \OO_K $ is a Dedekind domain and $ Cl\rb{K} = \OO_K $.

\begin{example*}
\hfill
\begin{itemize}
\item $ Cl\rb{K} = 1 $ if $ \OO_K $ is a PID or UFD. For example if $ K = \Q\rb{i}, \Q\rb{\omega}, \Q\rb{\sqrt{-11}} $.
\item $ Cl\rb{K} \ne 1 $ if $ K = \Q\rb{\sqrt{-5}}, \Q\rb{\sqrt{-6}} $. $ \ab{2, 1 + \sqrt{-5}} $ is not principal, and
$$ \ab{2, 1 + \sqrt{-5}}^2 = \ab{4, 2 + 2\sqrt{-5}, -4 + 2\sqrt{-5}} = \ab{2}, $$
so $ \Z / 2\Z $ is a subgroup of $ Cl\rb{K} $. Claim that $ \Z / 2\Z \cong Cl\rb{K} $. For example
$$ \ab{3, 1 - \sqrt{-5}} = \ab{a} \cdot \ab{2, 1 + \sqrt{-5}}, $$
where $ a = \rb{1 - \sqrt{-5}} / 2 \in \Q\rb{\sqrt{-5}}^\times $ because
\begin{itemize}
\item $ \rb{1 + \sqrt{-5}}a = \rb{1 + \sqrt{-5}}\rb{1 - \sqrt{-5}} / 2 = 3 $, and
\item $ 2a = 1 - \sqrt{-5} $.
\end{itemize}
\end{itemize}
\end{example*}

\begin{theorem}
If $ K $ is a number field, then $ Cl\rb{K} $ is finite.
\end{theorem}

Proof relies on an explicit bound. Every \textbf{ideal class}, a fractional ideal of $ \OO_K $ up to multiplication by principal ideals, contains a representative of norm less than an explicit bound depending on $ K $.

\pagebreak

\section{Finiteness of ideal class groups}

\subsection{Discriminants}

Let $ K $ be a number field. Recall $ \OO_K $ is a free $ \Z $-module of rank $ n = \deg\rb{K / \Q} $. Choose $ e_1, \dots, e_n $, a $ \Z $-basis of $ \Q $.
$$ \function[Tr_{K / \Q}\rb{,}]{K \times K}{\Q}{\rb{v, w}}{Tr_{K / \Q}\rb{v \cdot w}} $$
is symmetric, $ \Q $-bilinear, and non-degenerate. The \textbf{discriminant} of $ K $ is
$$ Disc\rb{K} = \det\rb{Tr_{K / \Q}\rb{e_i, e_j}_{i, j = 1, \dots, n}}. $$

\begin{remark*}
$ Disc\rb{K} \ne 0 $ and $ Disc\rb{K} \in \Z $.
\end{remark*}

\begin{lemma}
$ Disc\rb{K} $ is independent of choice of $ \Z $-basis $ e_1, \dots, e_n $.
\end{lemma}

\begin{proof}
If $ f_1, \dots, f_n $ is another $ \Z $-basis, there exists $ A \in M_n\rb{\Z} $ such that
$$ A\threebyone{e_1}{\vdots}{e_n} = \threebyone{f_1}{\vdots}{f_n}. $$
$ \det\rb{A} = \pm 1 $ and
$$ A^t \cdot \rb{Tr_{K / \Q}\rb{e_i, e_j}_{i, j}} \cdot A = \rb{Tr_{K / \Q}\rb{f_i, f_j}_{i, j}}, $$
so
$$ \det\rb{Tr_{K / \Q}\rb{e_i, e_j}_{i, j}} = \det\rb{Tr_{K / \Q}\rb{e_i, e_j}_{i, j}} \cdot \rb{\det\rb{A}}^2 = \det\rb{Tr_{K / \Q}\rb{f_i, f_j}_{i, j}}. $$
\end{proof}

\begin{example*}
Let $ K / \Q $ be quadratic, so $ K = \Q\rb{\sqrt{d}} $. Then
$$ Disc\rb{K} =
\begin{cases}
4d & d \equiv 2, 3 \mod 4, \ \OO_K = \ab{1, \sqrt{d}} \\
d & d \equiv 1 \mod 4, \ \OO_K = \ab{1, \tfrac{1 + \sqrt{d}}{2}}
\end{cases},
$$
since
$$ \twobytwo{Tr_{K / \Q}\rb{1}}{Tr_{K / \Q}\rb{\sqrt{d}}}{Tr_{K / \Q}\rb{\sqrt{d}}}{Tr_{K / \Q}\rb{d}} = \twobytwo{2}{0}{0}{2d}, \qquad \twobytwo{Tr_{K / \Q}\rb{1}}{Tr_{K / \Q}\rb{\tfrac{1 + \sqrt{d}}{2}}}{Tr_{K / \Q}\rb{\tfrac{1 + \sqrt{d}}{2}}}{Tr_{K / \Q}\rb{\tfrac{1 + d + 2\sqrt{d}}{4}}} = \twobytwo{2}{1}{1}{\tfrac{d + 1}{2}}. $$
\end{example*}

\pagebreak

\subsection{Decomposition of primes in quadratic fields}

Let $ p \in \Z $ be a rational prime. How does $ \ab{p} $ decompose, or factor, into prime ideals of $ \OO_K $?
\begin{itemize}
\item If $ \OO_K / \ab{p} \cong \F_p\sb{x} / x^2 $ we say $ \ab{p} $ ramifies in $ \OO_K $. Then $ \ab{p} = \pp^2 $, where $ \pp $ is a prime ideal of $ \OO_K $.
\item If $ \OO_K / \ab{p} \cong \F_p \times \F_p $ we say $ \ab{p} $ splits in $ \OO_K $. Then $ \ab{p} = \pp_1 \cdot \pp_2 $, where $ \pp_1 \ne \pp_2 $ are distinct prime ideals of $ \OO_K $.
\item If $ \OO_K / \ab{p} \cong \F_{p^2} $ we say $ \ab{p} $ is inert in $ \OO_K $. Then $ \ab{p} $ is a prime ideal of $ \OO_K $.
\end{itemize}
To see that these are the only possibilities when $ K / \Q $ is quadratic, key observation is $ \#\rb{\OO_K / \ab{p}} = p^2 $, so $ \OO_K / \ab{p} $ is an $ \F_p $-vector space of dimension two. The following is the criterion.

\lecture{23}{Monday}{04/03/19}

\begin{itemize}
\item $ p $ is ramified if and only if $ p \mid Disc\rb{K} $. More precisely,
\begin{itemize}
\item $ p \mid 4d $ if $ d \equiv 2, 3 \mod 4 $, and
\item $ p \mid d $ if $ d \equiv 1 \mod 4 $.
\end{itemize}
\item If $ d \equiv 1 \mod 4 $, then $ 2 $ is
\begin{itemize}
\item inert if $ d \equiv 5 \mod 8 $, and
\item split if $ d \equiv 1 \mod 8 $.
\end{itemize}
\item If $ p \ne 2 $ and $ p \nmid Disc\rb{K} $, then $ p $ is
\begin{itemize}
\item split if $ d $ is a quadratic residue mod $ p $, and
\item inert if $ d $ is not a quadratic residue mod $ p $.
\end{itemize}
Choose standard basis $ 1, \delta $ of $ \OO_K $.
$$ \delta =
\begin{cases}
\sqrt{d} & d \equiv 2, 3 \mod 4 \\
\tfrac{1 + \sqrt{d}}{2} & d \equiv 1 \mod 4
\end{cases}.
$$
Minimal polynomial equation of $ \delta $ is
$$ f\rb{x} =
\begin{cases}
x^2 - d & d \equiv 2, 3 \mod 4 \\
x^2 - x - \tfrac{d - 1}{4} & d \equiv 1 \mod 4
\end{cases}.
$$
Compute
$$ \dfrac{\OO_K}{\ab{p}} = \dfrac{\Z\sb{x}}{\ab{f\rb{x}, p}} = \dfrac{\F_p\sb{x}}{\ab{f\rb{x}}}. $$
$ p $ is inert if and only if $ \F_p\sb{x} / \ab{f\rb{x}} \cong \F_{p^2} $, if and only if $ f\rb{x} = 0 $.
\begin{itemize}
\item If $ d \equiv 2, 3 \mod 4 $, then $ x^2 - d = 0 $ has no solutions if and only if $ d $ is not a quadratic residue mod $ p $.
\item If $ d \equiv 1 \mod 4 $, then $ x^2 - x - \tfrac{d - 1}{4} = 0 $ has no solutions if and only if $ d $ is not a quadratic residue mod $ p $.
\end{itemize}
\end{itemize}

\pagebreak

\subsection{Standard form of ideals}

Goal is that if $ K $ is an imaginary quadratic field, so $ d < 0 $, then $ Cl\rb{K} $ is finite. Use that every ideal class in $ Cl\rb{K} $ contains an integral ideal of norm less than explicit bound depending on $ K $. Uses geometry of numbers and Minkowski's theorem. Let $ K $ be a quadratic field and $ \OO_K = \Z \oplus \Z\delta $ be the ring of integers, where
$$ \delta =
\begin{cases}
\sqrt{d} & d \equiv 2, 3 \mod 4 \\
\tfrac{1 + \sqrt{d}}{2} & d \equiv 1 \mod 4
\end{cases}.
$$

\begin{proposition}
Let $ I \subseteq \OO_K $ be an integral ideal. There exists $ a, b, d \in \Z $ such that the following hold.
\begin{itemize}
\item $ I = d\rb{\Z a + \Z\rb{-b + \delta}} $.
\item $ a \mid Nm_{K / \Q}\rb{-b + \delta} $.
\end{itemize}
\end{proposition}

Conversely, every subset of $ \OO_K $ of this form is an integral ideal. The expression
$$ I = d\rb{\Z a + \Z\rb{-b + \delta}} $$
is called the \textbf{standard form} of $ I $.

\begin{proof}
Let $ K $ be imaginary quadratic. $ \OO_K $ is a lattice $ \Lambda_0 $ generated by $ 1, \delta $ in $ K $. $ I $ is a lattice $ \Lambda \subseteq \Lambda_0 $. There exists $ \gamma \in M_2\rb{\Z} $ such that $ \Lambda = \gamma \cdot \Lambda_0 $. Can assume
$$ \gamma = \twobytwo{a'}{b'}{0}{d}, $$
for $ a', b', d \in \Z $. $ I = \Z a' + \Z\rb{b' + d\delta} $ is an ideal and $ a' \in I $ gives $ a'\delta = a'b + \rb{b' + d\delta}a \in I $ for $ a, b \in \Z $, so
$$ a'\rb{\delta - b} = \rb{b' + d\delta}a. $$
The coefficients of $ \delta $ gives $ a' = da $, and the coefficients of $ 1 $ gives $ -a'b = ab' $, so $ b' = -db $. Left to check that $ a \mid Nm_{K / \Q}\rb{-b + \delta} $. For simplicity assume $ d = 1 $. $ I $ is an ideal and $ -b + \delta \in I $ gives $ \delta\rb{-b + \delta} = af + \rb{-b + \delta}e \in I $ for $ e, f \in \Z $, so
$$ \rb{e - \delta}\rb{-b + \delta} = -af \in \Z. $$
If $ e - \delta = -b + \overline{\delta} $ the product would be $ \rb{-b + \overline{\delta}}\rb{-b + \delta} = Nm_{K / \Q}\rb{-b + \delta} = -af \in \Z $, if and only if $ a \mid Nm_{K / \Q}\rb{-b + \delta} $. Conversely,
$$ -af = \rb{e - \delta}\rb{-b + \delta} = \rb{e - \delta + b - \overline{\delta} + \rb{-b + \overline{\delta}}}\rb{-b + \delta} = \rb{e - \delta + b - \overline{\delta}}\rb{-b + \delta} + Nm_{K / \Q}\rb{-b + \delta}. $$
Then $ -af \in \Z $, $ Nm_{K / \Q}\rb{-b + \delta} \in \Z $, $ e - \delta + b - \overline{\delta} \in \Z $, and $ -b + \delta \in \OO_K \setminus \Z $, so $ e - \delta + b - \overline{\delta} = 0 $.
\end{proof}

An observation is that if $ I = d\rb{\Z a + \Z\rb{-b + \delta}} $ is in standard form, $ Nm\rb{I} = d^2 \cdot a $, since
$$ \det\twobytwo{a}{-b}{0}{1} = 0. $$

\pagebreak

\lecture{24}{Tuesday}{05/03/19}

\begin{example*}
Let
$$ I = \ab{2 + i} = \rb{2 + i}\Z + \rb{2 + i}i\Z = \rb{2 + i}\Z + \rb{2i - 1}\Z = \twobytwo{2}{-1}{1}{2} \cdot \Z\sb{i} \subsetneq \Z\sb{i}. $$
Column-reducing,
$$ \twobytwo{2}{-1}{1}{2} \sim \twobytwo{2}{-5}{1}{0} \sim \twobytwo{5}{2}{0}{1}. $$
Standard form is $ I = 5\Z + \rb{2 + i}\Z $. (Exercise: check that $ 5 = Nm_{\Z\sb{i} / \Z}\rb{2 + i} $)
\end{example*}

Let $ K $ be an imaginary quadratic field and
$$ J = q\rb{\Z a + \Z\rb{-b + \delta}} \subsetneq K, $$
for $ a, b \in \Z $ and $ q \in \Q^\times $, be a fractional ideal of $ \OO_K $. $ Nm\rb{J} = q^2 \cdot a $, by extending norm from ideals to fractional ideals multiplicatively. Standard form of $ J $ has fundamental parallelogram with vertices
$$ 0, \ qa, \ q\rb{-b + \delta}, \ qa + q\rb{-b + \delta}. $$
Let $ A\rb{J} $ be the area of the fundamental parallelogram of $ J $.

\begin{proposition}
$$ A\rb{J} = \dfrac{Nm\rb{J} \cdot \sqrt{Disc\rb{K}}}{2}. $$
\end{proposition}

\begin{proof}
$$ A\rb{J} = qa \cdot q\abs{Im\rb{\delta}} = q^2 \cdot a \cdot \abs{Im\rb{\delta}} = \dfrac{q^2 \cdot a \cdot \sqrt{Disc\rb{K}}}{2} = \dfrac{Nm\rb{J} \cdot \sqrt{Disc\rb{K}}}{2}. $$
\end{proof}

\subsection{Minkowski's theorem}

If $ J $ is a fractional ideal of $ K $, goal is to show that there exists $ \alpha \in J $ such that $ Nm\rb{\alpha} < C_K \cdot Nm\rb{J} $, where $ C_K $ is an explicit bound in terms of $ K $, so $ Nm\rb{\alpha \cdot J^{-1}} < C_K $. Up to multiplication by a principal ideal, can get $ Nm\rb{J^{-1}} < C_K $. Idea is to use Minkowski's theorem. Have a lattice $ \Lambda \subset \R^2 $ and a nice region $ S \subset \R^2 $. Let $ A\rb{\Lambda} $ be the area of the fundamental parallelogram of $ \Lambda $.

\begin{theorem}[Minkowski's theorem]
If $ A\rb{S} > 4A\rb{\Lambda} $ then $ S $ contains a non-zero lattice point, that is $ S \cap \Lambda \ne \emptyset $.
\end{theorem}

$ S $ is \textbf{nice}
\begin{itemize}
\item if $ x \in S $ then $ -x \in S $, and
\item $ S $ is convex, that is if $ x, y \in S $ then the segment $ \sb{x, y} \subset S $.
\end{itemize}

\begin{example*}
Let $ S $ be the closed or open disc of radius $ r > 2 / \sqrt{\pi} $ and $ \Lambda = \Z\sb{i} \subset \C $. Then $ A\rb{S} = \pi r^2 > 4 = 4A\rb{\Lambda} $.
\end{example*}

\begin{proof}
Consider all parallelograms of $ 2\Lambda $ that intersect $ S $. Translate elements of $ 2\Lambda $ until they all overlap.
$$ A\rb{2\Lambda} = 4A\rb{\Lambda} < A\rb{S} = A\rb{S_1} + \dots + A\rb{S_n}. $$
There exists $ S_i, S_j $ for $ i \ne j $ such that $ S_i \cap S_j \ne \emptyset $ translated. There exists $ x \in S \cap S_i $ and $ y \in S \cap S_j $ for $ i \ne j $ such that $ x - y \in 2\Lambda $. Claim that $ \rb{x - y} / 2 \in S \cap \Lambda $.
\begin{itemize}
\item $ x - y \in 2\Lambda $ gives $ \rb{x - y} / 2 \in \Lambda $.
\item $ \rb{x - y} / 2 \in S $ because $ y \in S $ gives $ -y \in S $, and $ x \in S $ gives the midpoint $ \rb{x - y} / 2 \in S $.
\end{itemize}
\end{proof}

\pagebreak

\subsection{Minkowski bound for imaginary quadratic fields}

\begin{theorem}
Let $ K $ be an imaginary quadratic field. Then every ideal class in $ Cl\rb{K} $ contains a representative $ I $ such that $ I $ is an integral ideal of norm less than
$$ \dfrac{2\sqrt{Disc\rb{K}}}{\pi}. $$
\end{theorem}

\begin{proof}
Back to $ J = q\rb{\Z a + \Z\rb{-b + \delta}} $ a fractional ideal of $ \OO_K $. Let $ S $ be the disc centred at the origin of radius
$$ r = \sqrt{\dfrac{2\sqrt{Disc\rb{K}} \cdot Nm\rb{J}}{\pi}} + \epsilon. $$
Then
$$ A\rb{S} > \pi r^2 = 2\sqrt{Disc\rb{K}} \cdot Nm\rb{J} = 4A\rb{J}. $$
Minkowski gives that there exists $ \alpha \in J $ such that $ \alpha \ne 0 $ and
$$ Nm_{K / \Q}\rb{\alpha} = \abs{\alpha}^2 < \dfrac{2\sqrt{Disc\rb{K}} \cdot Nm\rb{J}}{\pi} + \epsilon. $$
Thus there exists $ \alpha \in J $ such that
$$ Nm_{K / \Q}\rb{\alpha} < \dfrac{2\sqrt{Disc\rb{K}}}{\pi} \cdot Nm\rb{J}. $$
\end{proof}

(Exercise: prove $ Cl\rb{\Q\rb{\sqrt{-5}}} = \Z / 2\Z $)

\lecture{25}{Friday}{08/03/19}

Lecture 25 is a problem class.

\subsection{Minkowski bound for real quadratic fields}

\lecture{26}{Monday}{11/03/19}

Let $ K / \Q $ be a real quadratic field. Goal is that every ideal class in $ Cl\rb{K} $ contains a representative $ I \subseteq \OO_K $ such that $ Nm\rb{I} \le \sqrt{Disc\rb{K}} / 2 $. We will use Minkowski's theorem.

\begin{corollary}
If $ K $ is real quadratic, $ Cl\rb{K} $ is finite.
\end{corollary}

If $ K $ is real quadratic and $ J \subsetneq K $ is a fractional ideal, such as $ \OO_K $, then $ J \subsetneq \R $ is a dense subset. We will use instead the embedding
$$ \function[\iota]{K}{\R^2}{\alpha}{\rb{\overline{\alpha}, \alpha}}, $$
where $ \alpha = a + b\sqrt{d} $ and $ \overline{\alpha} = a - b\sqrt{d} $ for $ a, b \in \Q $ and $ d \in \Z_{> 0} $ is square-free, so
$$ a + b\sqrt{d} \mapsto \rb{a - b\sqrt{d}, a + b\sqrt{d}}. $$

\begin{lemma}
The image of a fractional ideal $ J \subsetneq K $ under $ \iota $ is a lattice in $ \R^2 $.
\end{lemma}

\begin{proof}
$ J $ is a free $ \Z $-module of rank two. Standard form is $ J = q\rb{a\Z + \rb{-b + \delta}\Z} $ for $ q \in \Q^\times $, $ a, b \in \Z $, and
$$ \delta =
\begin{cases}
\sqrt{d} & d \equiv 2, 3 \mod 4 \\
\tfrac{1 + \sqrt{d}}{2} & d \equiv 1 \mod 4
\end{cases}.
$$
$ \iota\rb{qa} = \rb{qa, qa} $ and $ \iota\rb{\rb{-b + \delta}q} = \rb{q\rb{-b + \overline{\delta}}, q\rb{-b + \delta}} $ are linearly independent over $ \Z $, since $ \delta \notin \Q $ gives that $ \overline{\delta} \ne \delta $, so $ \iota\rb{J} $ is the $ \Z $-lattice spanned by $ \rb{qa, qa} $ and $ \rb{q\rb{-b + \overline{\delta}}, q\rb{-b + \delta}} $.
\end{proof}

\begin{example*}
Let $ K = \Q\rb{\sqrt{5}} $. Then $ \OO_K \hookrightarrow \R^2 $ is the lattice generated by $ e_1 = \rb{1, 1} $ and $ e_2 = \rb{\tfrac{1 - \sqrt{5}}{2}, \tfrac{1 + \sqrt{5}}{2}} $.
\end{example*}

\pagebreak

$ Nm\rb{J} = q^2a $ and $ A\rb{J} $ is the area of the fundamental parallelogram of $ J $.

\begin{proposition}
If $ J = q\rb{a\Z + \rb{-b + \delta}\Z} $ is an ideal in standard form, then
$$ A\rb{J} = Nm\rb{J} \cdot \sqrt{Disc\rb{K}} = q^2a \cdot \sqrt{Disc\rb{K}}. $$
\end{proposition}

\begin{proof}
If $ d \equiv 2, 3 \mod 4 $, then
$$ \delta = \sqrt{d} = \dfrac{\sqrt{Disc\rb{K}}}{2}, \qquad \overline{\delta} = -\sqrt{d} = -\dfrac{\sqrt{Disc\rb{K}}}{2}. $$
If $ d \equiv 1 \mod 4 $, then
$$ \delta = \dfrac{1 + \sqrt{d}}{2} = \dfrac{1 + \sqrt{Disc\rb{K}}}{2}, \qquad \overline{\delta} = \dfrac{1 - \sqrt{d}}{2} = \dfrac{1 - \sqrt{Disc\rb{K}}}{2}. $$
Component of $ \rb{q\rb{-b + \overline{\delta}}, q\rb{-b + \delta}} $ along the line $ x = -y $ is
$$ \rb{-q\dfrac{\sqrt{Disc\rb{K}}}{2}, q\dfrac{\sqrt{Disc\rb{K}}}{2}}. $$
Component along $ x = y $ is
$$
\begin{cases}
\rb{-qb, -qb} & d \equiv 2, 3 \mod 4 \\
\rb{-qb + \tfrac{q}{2}, -qb + \tfrac{q}{2}} & d \equiv 1 \mod 4
\end{cases}.
$$
Thus
$$ A\rb{J} = qa\sqrt{2} \cdot \dfrac{q\sqrt{Disc\rb{K}}}{2} = q^2a \cdot \sqrt{Disc\rb{K}} = Nm\rb{J} \cdot \sqrt{Disc\rb{K}}. $$
\end{proof}

\begin{proposition}
\label{prop:bound}
If $ J \subsetneq K $ is a fractional ideal then there exists $ \alpha \in J $ such that
$$ Nm\rb{\alpha} < \dfrac{\sqrt{Disc\rb{K}} \cdot Nm\rb{J}}{2}. $$
\end{proposition}

\begin{corollary}
Every ideal class in $ Cl\rb{K} $ contains $ I \subseteq \OO_K $ such that
$$ Nm\rb{I} < \dfrac{\sqrt{Disc\rb{K}}}{2}. $$
\end{corollary}

\begin{proof}
Let $ I = \alpha \cdot J^{-1} $. Then $ I \subseteq \OO_K $ is an integral ideal and $ Nm\rb{I} = Nm\rb{\alpha} \cdot Nm\rb{J}^{-1} $. Proposition \ref{prop:bound} gives that $ Nm\rb{I} < \sqrt{Disc\rb{K}} / 2 $.
\end{proof}

\begin{proof}[Proof of Proposition \ref{prop:bound}]
Let
$$ \function{K}{\R^2}{\alpha}{\rb{\overline{\alpha}, \alpha}}. $$
$ Nm\rb{\alpha} = \overline{\alpha} \cdot \alpha $ is the restriction of $ Nm\rb{x, y} = x \cdot y $. Let $ H $ be
$$ \abs{x \cdot y} < \dfrac{\sqrt{Disc\rb{K}} \cdot Nm\rb{J}}{2}. $$
If we chose $ S $ to be that, we could not apply Minkowski, since it is not convex. Let $ S $ be
$$ \abs{x + y} < \sqrt{2\sqrt{Disc\rb{K}} \cdot Nm\rb{J}}, \qquad \abs{x - y} < \sqrt{2\sqrt{Disc\rb{K}} \cdot Nm\rb{J}}. $$
Then $ S $ is contained in $ H $. Assume $ x, y > 0 $. $ \rb{x, y} \in S $ gives that $ x + y < \sqrt{2\sqrt{Disc\rb{K}} \cdot Nm\rb{J}} $, so $ 4\abs{x \cdot y} \le \rb{x + y}^2 < 2\sqrt{Disc\rb{K}} \cdot Nm\rb{J} $, because $ \rb{x - y}^2 \ge 0 $. Thus $ \abs{x \cdot y} < \sqrt{Disc\rb{K}} \cdot Nm\rb{J} / 2 $, and
$$ A\rb{S} = 4\sqrt{Disc\rb{K}} \cdot Nm\rb{J} = 4A\rb{J}. $$
\end{proof}

\pagebreak

\subsection{Computing ideal class groups}

\lecture{27}{Tuesday}{12/03/19}

Recall that Minkowski's theorem gives the following Minkowski bounds $ \lambda\rb{K} $.
\begin{itemize}
\item If $ K $ is an imaginary quadratic field then every ideal class in $ Cl\rb{K} $ contains a representative $ I \subseteq \OO_K $ with
$$ Nm\rb{I} < \dfrac{2\sqrt{\abs{Disc\rb{K}}}}{\pi}. $$
\item If $ K $ is a real quadratic field then every ideal class in $ Cl\rb{K} $ contains a representative $ I \subseteq \OO_K $ with
$$ Nm\rb{I} < \dfrac{\sqrt{Disc\rb{K}}}{2}. $$
\end{itemize}

\begin{note*}
$ \pp \subsetneq \OO_K $ gives that
$$ \overline{\pp} = \cb{\overline{a} \mid a \in \pp} \subsetneq \OO_K $$
is also a prime ideal, and
$$ \pp \cdot \overline{\pp} = Nm\rb{\pp} = Nm\rb{\overline{\pp}}, $$
so there exist at most two prime ideals with a given norm. Thus $ Cl\rb{K} $ is finite.
\end{note*}

\begin{example*}
Trivial class groups.
\end{example*}

\begin{example*}
$ Cl\rb{\Q\rb{\sqrt{-5}}} \cong \Z / 2\Z $.
\end{example*}

\begin{example*}
What is $ Cl\rb{\Q\rb{\sqrt{-10}}} $?
\begin{itemize}
\item Minkowski bound is
$$ \dfrac{2\sqrt{40}}{\pi} = \dfrac{4\sqrt{10}}{\pi} = \sqrt{\dfrac{160}{\pi^2}} < \sqrt{\dfrac{160}{9}} < \sqrt{18} < 5, $$
so every ideal class in $ Cl\rb{\Q\rb{\sqrt{-10}}} $ contains a representative with norm at most four. Have to understand ideals $ \pp $ such that $ Nm\rb{\pp} = p \in \Z $, for $ p $ a prime number. Remark that in general, only need to consider, and factor, primes $ p < \lambda\rb{K} $ and such that $ p $ is ramified or split in $ K $.
\item We want to factor $ 2, 3 $ in $ K $.
\begin{itemize}
\item $ 2 \mid Disc\rb{K} = 40 $, so $ 2 $ ramifies. Then $ 2 = \pp^2 $ for some $ \pp \subsetneq \OO_K $ prime ideal of norm two. Let
$$ \pp = d\rb{a\Z + \rb{-b + \sqrt{-10}}\Z} $$
in standard form for $ a, b, d \in \Z $ such that $ a \mid Nm_{K / \Q}\rb{-b + \sqrt{-10}} $. $ 2 \in \pp $ gives that $ ad \mid 2 $.
\begin{itemize}
\item $ a = d = 1 $ gives $ \OO_K \ne \pp $.
\item $ d = 2 $ and $ a = 1 $ gives $ \ab{2} \ne \pp $.
\item $ d = 1 $ and $ a = 2 $ gives $ 2 \mid Nm_{K / \Q}\rb{-b + \sqrt{-10}} = b^2 + 10 $, so $ b \equiv 0 \mod 2 $. Take $ b = 0 $.
\end{itemize}
In general, get congruence condition $ b \equiv 0 \mod a $ in the ramified case or $ b = \pm c \mod a $ for $ a \nmid c $ in the split case. Thus
$$ \pp = 2\Z + \sqrt{-10}\Z = \ab{2, \sqrt{-10}}, \qquad \pp^2 = \ab{4, 2\sqrt{-10}, -10} = \ab{2}. $$
\item $ 3 \nmid Disc\rb{K} = 40 $ and $ x^2 + 10 \equiv 0 \mod 3 $ has no solutions, so $ 3 $ is inert.
\end{itemize}
\item Check whether $ \pp = \ab{2, \sqrt{-10}} $ is principal or not. If $ \pp = \ab{\alpha} $ for $ \alpha = a + b\sqrt{-10} $,
$$ 2 = Nm_{K / \Q}\rb{\alpha} = a^2 + 10b^2 $$
has no solutions with $ a, b \in \Z $, so $ \pp $ is not principal, and $ \pp^2 = \ab{2} $ is principal.
\end{itemize}
Thus $ Cl\rb{\Q\rb{\sqrt{-10}}} \cong \Z / 2\Z $.
\end{example*}

\pagebreak

\begin{example*}
What is $ Cl\rb{\Q\rb{\sqrt{-21}}} $?
\begin{itemize}
\item Minkowski bound is
$$ \lambda\rb{K} = \dfrac{2\sqrt{84}}{\pi} = \sqrt{\dfrac{336}{\pi^2}} < 6. $$
\item We want to factor $ 2, 3, 5 $ in $ K $.
\begin{itemize}
\item $ 2 \mid Disc\rb{K} $, so $ 2 $ ramifies, and
$$ \ab{2, 1 + \sqrt{-21}}^2 = \ab{4, 2\sqrt{-21}, 2} = \ab{2}. $$
Let $ \pp_2 = \ab{2, 1 + \sqrt{-21}} $. Then
$$ 2 = Nm\rb{\pp_2} = a^2 + 21b^2 $$
has no solutions with $ a, b \in \Z $, so $ \pp_2 $ is not principal.
\item $ 3 \mid Disc\rb{K} $, so $ 3 $ ramifies, and
$$ \ab{3, \sqrt{-21}}^2 = \ab{9, 3\sqrt{-21}, -21} = \ab{3}. $$
Let $ \pp_3 = \ab{3, \sqrt{-21}} $. Then
$$ 3 = Nm\rb{\pp_3} = a^2 + 21b^2 $$
has no solutions with $ a, b \in \Z $, so $ \pp_3 $ is not principal.
\item $ 5 $ splits, since $ x^2 + 21 \equiv 0 \mod 5 $ has solutions $ x \equiv \pm 2 \mod 5 $. Then
$$ \ab{5} = \pp_5 \cdot \overline{\pp_5}, $$
for $ \pp_5 = \ab{5, -b + \sqrt{-21}} $ and $ 5 \mid b^2 + 21 $, so $ b = \pm 2 $. Then
$$ 5 = Nm\rb{\pp_5} = a^2 + 21b^2 $$
has no solutions with $ a, b \in \Z $, so $ \pp_5 $ is not principal.
\end{itemize}
\item Compute
$$ \pp_2 \cdot \pp_3 = \ab{2, 1 + \sqrt{-21}}\ab{3, \sqrt{-21}} = \ab{6, 3\rb{1 + \sqrt{-21}}, 2\sqrt{-21}, \sqrt{-21} - 21} = \ab{6, 3 + \sqrt{-21}}, $$
and
$$ \pp_2 \cdot \pp_3 \cdot \ab{\dfrac{3 - \sqrt{-21}}{6}} = \ab{3 - \sqrt{-21}, 5} = \ab{5, -2 + \sqrt{-21}} = \pp_5. $$
\end{itemize}
Thus $ Cl\rb{\Q\rb{\sqrt{-21}}} \cong \Z / 2\Z \times \Z / 2\Z $ is the Klein four group.
\end{example*}

\begin{example*}
$ Cl\rb{\Q\rb{\sqrt{-23}}} \cong \Z / 3\Z $.
\end{example*}

\pagebreak

\subsection{Solving Diophantine equations}

\lecture{28}{Friday}{15/03/19}

Goal is solving Diophantine equations, an application of the class group. \textbf{Mordell's equation} is $ x^2 + n = y^3 $ for $ n \in \Z $ given.

\begin{theorem}
For any $ n \in \Z $, the equation $ x^2 + n = y^3 $ has only finitely many solutions with $ x, y \in \Z $.
\end{theorem}

\begin{example*}
$ x^2 + 1 = y^3 $ has solution $ \rb{0, 1} $. Use $ \Q\rb{i} $ is a UFD or a PID or a Euclidean domain.
\end{example*}

\begin{example*}
$ x^2 + 2 = y^3 $ has solutions $ \rb{\pm 5, 3} $. Use $ \Q\rb{\sqrt{-2}} $ is a UFD or a PID or a Euclidean domain.
\end{example*}

\begin{example*}
$ x^2 + 5 = y^3 $. $ \Q\rb{\sqrt{-5}} $ is not a UFD, since $ Cl\rb{\Q\rb{\sqrt{-5}}} = \Z / 2\Z $. $ x^2 \equiv 0, 1, 4 \mod 8 $, so $ x^2 + 5 \equiv 5, 6, 1 \mod 8 $, but if $ 2 \mid y $, then $ 8 \mid y^3 $, so $ x^2 + 5 \equiv 0 \mod 8 $, a contradiction, so $ 2 \nmid y $ and $ y $ is odd.
$$ \rb{x + \sqrt{-5}}\rb{x - \sqrt{-5}} = y^3 $$
is the factorisation in $ \Z\sb{\sqrt{-5}} $. Are the ideals $ \ab{x + \sqrt{-5}} $ and $ \ab{x - \sqrt{-5}} $ relatively prime? If $ \pp \subsetneq \Z\sb{\sqrt{-5}} $ is a prime ideal such that $ \pp \mid \ab{x + \sqrt{-5}} $ and $ \pp \mid \ab{x - \sqrt{-5}} $, then $ \pp \mid 2x $, $ \pp \mid 2\sqrt{-5} $, and $ Nm\rb{\pp} \mid y^3 $, so $ Nm\rb{\pp} \mid \gcd\rb{20, y^3} = \gcd\rb{5, y^3} $, which is either one or five.
\begin{itemize}
\item Assume $ Nm\rb{\pp} = 5 $. $ Nm\rb{\pp} \mid y^3 $ and $ Nm\rb{\pp} \mid x^2 $ gives that $ 5 \mid x $ and $ 5 \mid y $, so $ 5 = y^3 - x^3 $ is a multiple of $ 25 $, which has no solutions, a contradiction.
\item $ Nm\rb{\pp} = 1 $ and $ \pp $ is prime is a contradiction.
\end{itemize}
Then $ \ab{x + \sqrt{-5}} $ and $ \ab{x - \sqrt{-5}} $ are relatively prime ideals, so there exist $ I, J \subseteq \Z\sb{\sqrt{-5}} $ ideals such that
$$ \ab{x + \sqrt{-5}} = I^3, \qquad \ab{x - \sqrt{-5}} = J^3, $$
using unique factorisation into prime ideals. Are $ I, J $ principal ideals? Recall $ Cl\rb{\Q\rb{\sqrt{-5}}} = \Z / 2\Z $. Assume $ I $ is not principal, so $ I = \ab{a} \cdot \ab{2, 1 + \sqrt{-5}} $ for $ a \in \Q\rb{\sqrt{-5}}^\times $, but then
$$ I^3 = \ab{a^3} \cdot \ab{2} \cdot \ab{2, 1 + \sqrt{-5}} = \ab{2a^3} \cdot \ab{2, 1 + \sqrt{-5}}, $$
which is not a principal ideal, so $ I $ was principal to begin with. Key idea is that $ 3 \nmid \#Cl\rb{\Q\rb{\sqrt{-5}}} $. The argument does not work if $ 3 \mid \#Cl\rb{K} $ for $ K $ a quadratic field. Similarly, $ J $ is a principal ideal. Can I say $ x + \sqrt{-5} = \rb{a + b\sqrt{-5}}^3 $ for $ a, b \in \Z $? In general, only up to units in $ \Z\sb{\sqrt{-5}} $, and $ \Z\sb{\sqrt{-5}}^\times = \cb{\pm 1} $ are cubes. So, indeed, we have
$$ x + \sqrt{-5} = \rb{a + b\sqrt{-5}}^3, \qquad x - \sqrt{-5} = \rb{a - b\sqrt{-5}}^3, $$
for $ a, b \in \Z $. Then
$$ x + \sqrt{-5} = a^3 + 3a^2b\sqrt{-5} - 15ab^2 - 5b^3\sqrt{-5}, $$
so get Diophantine equation $ 3a^2b - 5b^3 = 1 $ for $ a, b \in \Z $, which gives $ b\rb{3a^2 - 5b^2} = 1 $, so $ b = \pm 1 $.
\begin{itemize}
\item $ b = 1 $ gives $ 3a^2 = 6 $, which has no solution.
\item $ b = -1 $ gives $ 3a^2 = 4 $, which has no solution.
\end{itemize}
\end{example*}

\pagebreak

\begin{example*}
$ x^2 + 11 = y^3 $. We factor this as
$$ \rb{x + \sqrt{-11}}\rb{x - \sqrt{-11}} = y^3. $$
The relevant number field for this equation is $ \Q\rb{\sqrt{-11}} $, which is a principal ideal domain. We had seen earlier in the course that it is even a Euclidean domain. One can also prove that the class group is trivial by considering the Minkowski bound
$$ \lambda\rb{K} = \dfrac{2\sqrt{11}}{\pi} < 3. $$
This means we only need to understand how to factor $ 2 $ and since $ -11 \equiv 5 \mod 8 $, we know that $ 2 $ must stay inert, so it does not give rise to any non-principal ideal. We prove as before that $ y $ must be odd and that the ideals $ \ab{x + \sqrt{-11}} $ and $ \ab{x - \sqrt{-11}} $ are relatively prime. Using unique factorisation, also noting that the units $ \pm 1 $ are both cubes, we deduce that
$$ x + \sqrt{-11} = \dfrac{\rb{a + b\sqrt{-11}}^3}{8}, \qquad x - \sqrt{-11} = \dfrac{\rb{a - b\sqrt{-11}}^3}{8}, $$
where $ a, b \in \Z $ must have the same parity. We obtain the Diophantine equation $ 8 = 3a^2b - 11b^3 $. This has solutions $ \rb{a, b} = \rb{\pm 1, 1} $ and $ \rb{a, b} = \rb{\pm 4, 2} $. These give the solutions $ \rb{x, y} = \rb{\pm 4, 3} $ and $ \rb{x, y} = \rb{\pm 15, 58} $.
\end{example*}

\begin{example*}
$ x^2 - 7 = y^3 $.
$$ x^2 - 7 = \rb{x + \sqrt{7}}\rb{x - \sqrt{7}} = y^3 $$
in $ K = \Q\rb{\sqrt{7}} $, a real quadratic field. Claim $ Cl\rb{K} = 1 $. Minkowski bound is
$$ \lambda\rb{K} = \sqrt{7} < 3, $$
that is at most $ 2 $, and $ 2 $ ramifies, since $ 2 \mid 28 = Disc\rb{K} $, and
$$ \ab{2} = \ab{2, 1 + \sqrt{7}}^2 = \ab{3 + \sqrt{7}}^2, $$
so $ K $ is a PID. $ x + \sqrt{7} = u \cdot \rb{a + b\sqrt{7}}^3 $ for $ u \in \Z\sb{\sqrt{7}}^\times $. Problem is
$$ \Z\sb{\sqrt{7}}^\times = \cb{\pm\epsilon^k \mid k \in \Z} \cong \cb{\pm 1} \times \Z, $$
where $ \epsilon = 8 + \sqrt{7} \cdot 3 $ such that
$$ Nm\rb{\epsilon} = \rb{8 + \sqrt{7} \cdot 3}\rb{8 - \sqrt{7} \cdot 3} = 64 - 63 = 1. $$
The following is an elementary solution.
$$ x^2 + 1 = y^3 + 8 = \rb{y + 2}\rb{y^2 - 2y + 4} = \rb{y + 2}\rb{\rb{y - 1}^2 + 3}. $$
$ y $ is odd and $ y - 1 $ is even, so
$$ x^2 + 1 = \rb{y + 2}\rb{4k + 3}, $$
for some $ k \in \Z $. Then there exists $ p \equiv 3 \mod 4 $ prime such that $ p \mid x^2 + 1 $ but $ -1 $ is not a square mod $ p $ if $ p \equiv 3 \mod 4 $, since $ \jacobi{-1}{p} = \rb{-1}^{\rb{p - 1} / 2} = -1 $, a contradiction. Thus $ x^2 - 7 = y^3 $ has no solutions with $ x, y \in \Z $.
\end{example*}

\begin{remark*}
$ x^2 + n = y^3 $ with $ n > 0 $, if $ 3 \nmid \#Cl\rb{\Q\rb{\sqrt{-n}}} $, then the equation has at most two pairs of solutions $ \rb{\pm x, y} $.
\end{remark*}

\pagebreak

\subsection{Fundamental units}

\lecture{29}{Monday}{18/03/19}

Goal is to discuss the group of units $ \OO_K^\times $ when $ K $ is a real quadratic field. If $ K $ is imaginary quadratic, then
$$ \OO_K^\times =
\begin{cases}
\Z / 4\Z & K = \Q\rb{i} \\
\Z / 6\Z & K = \Q\rb{\omega} \\
\Z / 2\Z & \text{otherwise}
\end{cases}.
$$

\begin{theorem}
If $ K $ is real quadratic, then
\begin{align*}
\OO_K^\times & \cong \cb{\pm 1} \times \Z \\
\pm\epsilon^k & \mapsfrom \rb{\pm 1, k},
\end{align*}
with $ \epsilon \in \OO_K^\times $ a \textbf{fundamental unit}, that is the smallest element of $ \OO_K^\times $ such that $ \epsilon > 1 $.
\end{theorem}

In general, $ Nm_{K / \Q}\rb{\epsilon} = \pm 1 $. To find $ \OO_K^\times $, we will look at solutions to \textbf{Pell's equation} $ x^2 - dy^2 = \pm 1 $, where $ K = \Q\rb{\sqrt{d}} $ for $ d > 0 $ square-free and $ \epsilon = x + \sqrt{d} \cdot y $.

\begin{example*}
Let $ K = \Q\rb{\sqrt{5}} $. Then $ x^2 - 5y^2 = -1 $ has solution $ \rb{x, y} = \rb{\pm 2, \pm 1} $, since $ 2 + \sqrt{5} $ has
$$ Nm_{K / \Q}\rb{2 + \sqrt{5}} = \rb{2 + \sqrt{5}}\rb{2 - \sqrt{5}} = -1. $$
\end{example*}

\begin{lemma}
Let $ \epsilon \in \OO_K^\times $ be such that $ \epsilon > 1 $ and $ \epsilon $ is the smallest element of $ \OO_K^\times $ with this property. Then any $ \epsilon' \in \OO_K^\times $ satisfies $ \epsilon' = \pm\epsilon^k $ for some $ k \in \Z $.
\end{lemma}

\begin{proof}
Let
$$ [\epsilon, \infty) = [\epsilon, \epsilon^2) \cup [\epsilon^2, \epsilon^3) \cup \dots. $$
Then $ \epsilon' \in \R^\times \setminus \cb{\pm 1} $, so one of $ \epsilon', -\epsilon', 1 / \epsilon', -1 / \epsilon' $ is greater than one. If either of these is $ \pm\epsilon^k $, for $ k \in \Z $, then $ \epsilon' $ is of this form as well. We may assume $ \epsilon' > 1 $, so $ \epsilon' > \epsilon $ gives that $ \epsilon' \in [\epsilon^k, \epsilon^{k + 1}) $ for some $ k \in \Z_{\ge 1} $. Then $ \epsilon' / \epsilon^k \in \OO_K^\times $ and $ \epsilon' / \epsilon^k \in [1, \epsilon) $. This gives a contradiction unless $ \epsilon' / \epsilon^k = 1 $, so $ \epsilon' = \epsilon^k $.
\end{proof}

\subsection{Continued fractions}

Goal is to understand solutions to Pell's equation $ x^2 - dy^2 = \pm 1 $. If $ \rb{x, y} $ is a solution for $ x, y > 0 $ then $ x / y \in \Q $ is close to $ \sqrt{d} \in \R \setminus \Q $. In fact it is the best rational approximation to $ \sqrt{d} $. The theory of \textbf{continued fractions} gives a way of constructing such rational approximations for $ \alpha \in \R \setminus \Q $. Let $ a_0 = \fb{\alpha} \in \Z $. If $ a_0 = \alpha $ terminate here. If not, then $ \alpha - a_0 \in \rb{0, 1} $, so
$$ a_0 + \dfrac{1}{a_1} = \dfrac{a_0a_1 + 1}{a_1} \in \Q, \qquad a_1 = \fb{\dfrac{1}{\alpha - a_0}} \in \Z_{\ge 1}. $$
If $ a_1 = 1 / \rb{\alpha - a_0} $ terminate here. If not, then $ 1 / \rb{\alpha - a_0} - a_1 \in \rb{0, 1} $, so
$$ a_0 + \dfrac{1}{a_1 + \tfrac{1}{a_2}} = a_0 + \dfrac{1}{\tfrac{a_1a_2 + 1}{a_2}} = \dfrac{a_0a_1a_2 + a_0 + a_2}{a_1a_2 + 1} \in \Q, \qquad a_2 = \fb{\dfrac{1}{\tfrac{1}{\alpha - a_0} - a_1}}. $$
Let
$$ \sb{a_0; a_1, \dots, a_n} = a_0 + \dfrac{1}{a_1 + \tfrac{1}{\dots + \tfrac{1}{a_n}}} \in \Q. $$
Then $ \sb{a_0; a_1, \dots, a_n} \to \alpha $ when $ n \to \infty $.

\begin{lemma}
The continued fraction expansion of $ \alpha \in \R $ terminates if and only if $ \alpha \in \Q $. If $ \alpha \in \R \setminus \Q $ the continued fraction expansion is $ \sb{a_0; a_1, \dots} $, where $ a_0 \in \Z $ and $ a_1, a_2, \dots \in \Z_{\ge 1} $. Then
$$ a_0 + \dfrac{1}{a_1 + \tfrac{1}{\dots}} $$
converges to $ \alpha $.
\end{lemma}

\pagebreak

\begin{example*}
$$ \dfrac{1 + \sqrt{5}}{2} = 1 + \dfrac{\sqrt{5} - 1}{2} = 1 + \dfrac{1}{\tfrac{2}{\sqrt{5} - 1}} = 1 + \dfrac{1}{\tfrac{2\rb{1 + \sqrt{5}}}{4}} = 1 + \dfrac{1}{\tfrac{1 + \sqrt{5}}{2}} = 1 + \dfrac{1}{1 + \tfrac{1}{\dots}} = \sb{1; 1, 1, \dots} = \sb{\overline{1}} $$
is \textbf{purely periodic}.
$$ \sqrt{7} = 2 + \rb{\sqrt{7} - 2} = 2 + \dfrac{1}{\tfrac{\sqrt{7} + 2}{3}} = 2 + \dfrac{1}{1 + \tfrac{\sqrt{7} - 1}{3}} = \dots = \sb{2; 1, 1, 1, 4, 1, 1, 1, 4, \dots} = \sb{2; \overline{1, 1, 1, 4}} $$
is \textbf{periodic}.
\end{example*}

\begin{theorem}
The continued fraction expansion of an element $ \alpha \in \R \setminus \Q $ is periodic if and only if $ \alpha $ is a quadratic number, that is $ \alpha \in \Q\rb{\sqrt{d}} $, for $ d > 0 $ square-free.
\end{theorem}

\lecture{30}{Tuesday}{19/03/19}

\begin{definition}
Let $ \sb{a_0; a_1, a_2, \dots} $. The \textbf{$ i $-th convergent} is the truncated expansion
$$ \sb{a_0; a_1, \dots, a_i} = a_0 + \dfrac{1}{a_1 + \tfrac{1}{\dots + \tfrac{1}{a_i}}}. $$
\end{definition}

\begin{definition}
Let $ \cb{p_i}_{i = -2}^\infty $ and $ \cb{q_i}_{i = -2}^\infty $ be the sequences defined by
$$ p_{-2} = 0, \qquad p_{-1} = 1, \qquad p_{i + 1} = a_{i + 1}p_i + p_{i - 1}, \qquad q_{-2} = 1, \qquad q_{-1} = 0, \qquad q_{i + 1} = a_{i + 1}q_i + q_{i - 1}, $$
so $ p_0 = a_0 $, $ p_1 = a_1a_0 + 1 $, $ q_0 = 1 $, and $ q_1 = a_1 $.
\end{definition}

\begin{lemma}
We have
$$ \dfrac{p_i}{q_i} = \sb{a_0; a_1, \dots, a_i}. $$
\end{lemma}

\begin{proof}
$ \sb{a_0} = a_0 = p_0 / q_0 $ and $ \sb{a_0; a_1} = a_0 + 1 / a_1 = \rb{a_0a_1 + 1} / a_1 = p_1 / q_1 $. Proof by induction on $ i $. The key idea is to apply the $ \rb{i - 1} $-st step to
$$ \sb{a_0; a_1, \dots, a_i} = \sb{a_0; a_1, \dots, a_{i - 1} + \dfrac{1}{a_i}}, $$
the $ \rb{i - 1} $-st convergent.
\end{proof}

\begin{proposition}
\label{prop:convergent}
The $ i $-th convergent $ p_i / q_i $ satisfy the following.
\begin{enumerate}
\item $ p_iq_{i - 1} - q_ip_{i - 1} = \rb{-1}^{i - 1} $. In particular, $ \gcd\rb{p_i, q_i} = 1 $ and also
$$ \abs{\dfrac{p_i}{q_i} - \dfrac{p_{i - 1}}{q_{i - 1}}} = \dfrac{1}{q_iq_{i - 1}} = \abs{\dfrac{p_iq_{i - 1} - p_{i - 1}q_i}{q_iq_{i - 1}}} = \abs{\dfrac{1}{q_iq_{i - 1}}}. $$
\item If $ x = \sb{a_0; a_1, \dots} \in \R \setminus \Q $ and $ p_i / q_i = \sb{a_0; a_1, \dots, a_i} $ then $ p_i / q_i < x $ for $ i $ even and $ p_i / q_i > x $ for $ i $ odd. In particular,
$$ \dfrac{p_i}{q_i} < x < \dfrac{p_{i - 1}}{q_{i - 1}}, $$
for $ i $ even, so
$$ \abs{x - \dfrac{p_i}{q_i}} < \abs{\dfrac{p_{i - 1}}{q_{i - 1}} - \dfrac{p_i}{q_i}} = \dfrac{1}{q_iq_{i - 1}} < \dfrac{1}{\rb{i - 1}^2} $$
because $ q_i \ge i $.
\end{enumerate}
\end{proposition}

\pagebreak

\begin{corollary}
$ \sb{a_0; a_1, \dots, a_i} \to x $ as $ i \to \infty $.
\end{corollary}

In other words
$$ x = \sb{a_0; a_1, \dots} = a_0 + \dfrac{1}{a_1 + \tfrac{1}{\dots}} $$
makes sense.

\begin{proof}[Proof of Proposition \ref{prop:convergent}]
By induction on $ i $.
\begin{enumerate}
\item Use $ i - 1 $ case and recurrence for $ \cb{p_i}_i $ and $ \cb{q_i}_i $.
\item $ \sb{a_1; a_2, \dots, a_i} $ is the $ \rb{i - 1} $-st convergent to $ 1 / \rb{x - a_0} $. If $ i $ is even and $ i - 1 $ is odd, by induction hypothesis
$$ \sb{a_1; a_2, \dots, a_i} > \dfrac{1}{x - a_0} \qquad \iff \qquad x > a_0 + \dfrac{1}{\sb{a_1; a_2, \dots, a_i}} = \sb{a_0; a_1, \dots, a_i}. $$
Similarly $ i $ is odd and $ i - 1 $ is even.
\end{enumerate}
\end{proof}

In conclusion, $ p_i / q_i \to x $ as $ i \to \infty $ and
$$ \abs{\dfrac{p_i}{q_i} - x} < \dfrac{1}{q_iq_{i + 1}} < \dfrac{1}{q_i^2}. $$

\begin{theorem}[Best rational approximation]
If $ r, s \in \Z $ such that $ 0 < \abs{s} \le q_i $ then
$$ \abs{x - \dfrac{r}{s}} \ge \abs{x - \dfrac{p_i}{q_i}}, $$
with equality only if $ r / s = p_i / q_i $.
\end{theorem}

\subsection{Pell's equation}

If $ d = 0 $ is square-free, then $ \sqrt{d} = \sb{a_0; \overline{a_1, \dots, a_m}} $ is periodic, but not purely periodic. $ \fb{\sqrt{d}} + \sqrt{d} $ is purely periodic.

\begin{theorem}
The solutions to Pell's equation $ x^2 - dy^2 = \pm 1 $ are the $ \rb{p_n, q_n} $ with $ n = km - 1 $ for $ k \in \Z_{\ge 1} $ and moreover
$$ p_n^2 - dq_n^2 = \rb{-1}^{km}. $$
In particular $ x^2 - dy^2 = -1 $ has a solution if and only if $ m $ is odd.
\end{theorem}

\begin{example*}
\hfill
\begin{itemize}
\item Let $ \Q\rb{\sqrt{7}} \supseteq \Z\sb{\sqrt{7}} $. Then $ \sqrt{7} = \sb{2, \overline{1, 1, 1, 4}} $ has period length four. $ x^2 - 7y^2 = -1 $ has no solutions. $ x^2 - 7y^2 = 1 $ has solutions $ \rb{p_{4k - 1}, q_{4k - 1}} $. Fundamental solution is $ \rb{p_3, q_3} $.
$$ 2 + \dfrac{1}{1 + \tfrac{1}{2}} = 2 + \dfrac{1}{\tfrac{3}{2}} = 2 + \dfrac{2}{3} = \dfrac{8}{3}, $$
so $ \rb{p_3, q_3} = \rb{8, 3} $. Thus $ 8 + \sqrt{7} \cdot 3 $ is the fundamental unit, so $ \Z\sb{\sqrt{7}}^\times = \cb{\pm 1} \times \cb{\epsilon^k \mid k \in \Z} $, where $ \epsilon = 8 + \sqrt{7} \cdot 3 $.
\item Let $ \Q\rb{\sqrt{13}} \supseteq \Z\sb{\tfrac{1 + \sqrt{13}}{2}} $. What is $ \Z\sb{\tfrac{1 + \sqrt{13}}{2}}^\times $? $ \sqrt{13} = \sb{3; \overline{1, 1, 1, 1, 6}} $ has period length five. $ x^2 - 13y^2 = -1 $ has solutions $ \rb{p_4, q_4} $.
$$ 3 + \dfrac{1}{1 + \tfrac{1}{1 + \tfrac{1}{1 + \tfrac{1}{1}}}} = \dfrac{18}{5}, $$
so $ \rb{p_4, q_4} = \rb{18, 5} $. Thus $ 18 + \sqrt{13} \cdot 5 $ is a fundamental unit.
\end{itemize}
\end{example*}

\pagebreak

\appendix

\section{Fermat's last theorem}

\lecture{31}{Friday}{22/03/19}

\subsection{History}

The following theorem is conjectured by Fermat and proved by Taylor-Wiles.

\begin{theorem}
$ x^n + y^n = z^n $ has no non-trivial solutions if $ n \ge 3 $.
\end{theorem}

Initial idea is that it is enough to consider case $ n = 4 $ and $ n = p $ for $ p $ odd prime.

\begin{theorem}[Fermat]
$ x^4 + y^4 = z^4 $ has no non-trivial solutions.
\end{theorem}

\begin{proof}
Use infinite descent argument. Assume a solution $ \rb{x, y, z} $ and construct a solution $ \rb{x', y', z'} $ that is smaller for some measure.
\end{proof}

\begin{theorem}[Euler]
$ x^3 + y^3 = z^3 $ has no non-trivial solutions.
\end{theorem}

\begin{proof}
Use factorisation $ \rb{x + y}\rb{x + \omega y}\rb{x + \omega^2y} = z^3 $ in the Eisenstein integers $ \Z\sb{\omega} $, where $ \omega^3 = 1 $ is the primitive cube of unity, which is a unique factorisation domain.
\begin{itemize}
\item Find common prime factors of $ \ab{x + y} $, $ \ab{x + \omega y} $, $ \ab{x + \omega^2y} $.
\item Use unique factorisation to show that $ \ab{x + y} = I^3 \cdot \gcd\rb{\ab{x + y}, \ab{x + \omega y}, \ab{x + \omega^2y}} $.
\end{itemize}
Then use infinite descent.
\end{proof}

More generally, $ x^p + y^p = z^p $ factors as $ \prod_{i = 0}^{p - 1} \rb{x + \zeta_p^iy} = z^p $, for $ \zeta_p $ a primitive $ p $-th root of unity, in the ring of integers $ \OO_K \subseteq K $ of a \textbf{cyclotomic field} $ K = \Q\rb{\zeta_p} / \Q $, an extension of degree $ p - 1 $. Can try to adopt strategy from $ p = 3 $ to general $ p $. Problem is that there is no reason to believe $ \OO_K $ is a UFD or a PID, so there is no reason to expect $ Cl\rb{K} = 1 $. If $ p \nmid \#Cl\rb{K} $, the same idea works. Such $ p $ are called \textbf{regular}.

\begin{theorem}[Kummer]
$ x^p + y^p = z^p $ has no non-trivial solutions if $ p $ is regular.
\end{theorem}

\begin{example*}
If $ \gcd\rb{x - \zeta_p^iy, x + \zeta_p^jy} = 1 $ for $ i \ne j $, then $ x + \zeta_p^iy = u_i\alpha_i^p $ for $ i = 0, \dots, p - 1 $.
\end{example*}

Problem is that there exist infinitely many primes such that $ p \mid \#Cl\rb{\Q\rb{\zeta_p}} $, such as $ p = 37 $.

\subsection{Class field theory}

Let $ K / \Q $ be a number field. Then $ Cl\rb{K} = I / P $ is a finite abelian group, where $ I $ is all the non-zero fractional ideals of $ K $ and $ P $ is all the non-zero principal ideals of $ K $. If $ L / K $ is a finite field extension, the \textbf{Galois group} $ Gal\rb{L / K} $ is the group of field automorphisms of $ L $ that are identity on $ K $.

\begin{example*}
Let $ L = \Q\rb{\sqrt{d}} $ be a quadratic field and $ K = \Q $. Then $ Gal\rb{L / K} = \Z / 2\Z = \cb{1, \tau} $ is generated by $ \tau : \sqrt{d} \mapsto -\sqrt{d} $.
\end{example*}

There exists a finite extension $ L / K $ \textbf{unramified everywhere}. All prime ideals $ \pp \subsetneq \OO_K $ of $ K $ either split or stay inert in $ L $, so $ \pp = \pp_1 \cdot \dots \cdot \pp_g $ for some $ g \in \Z $ and prime ideals $ \pp_1, \dots, \pp_g \subsetneq \OO_L $ all distinct, and $ L / K $ is unramified at \textbf{infinite places}. Moreover $ Gal\rb{L / K} $ is abelian. Then $ L $ is the \textbf{Hilbert class field} of $ K $, the biggest finite abelian extension of $ K $ which is unramified everywhere.

\begin{theorem}
$ Cl\rb{K} \cong Gal\rb{L / K} $.
\end{theorem}

\begin{example*}
Let $ Cl\rb{K} \cong \Z / 4\Z $.
\begin{itemize}
\item There exists a quadratic extension $ L_1 / K $ unramified everywhere with $ Gal\rb{L_1 / K} \cong \Z / 2\Z $.
\item There exists a quadratic extension $ L_2 / L_1 $ unramified everywhere with $ Gal\rb{L_2 / L_1} \cong \Z / 2\Z $.
\end{itemize}
Then $ L_2 $ is the Hilbert class field of $ K $.
\end{example*}

\pagebreak

Can generalise this picture to ideals $ \mm \subseteq \OO_K $. The \textbf{ray class group} of \textbf{conductor} $ \mm $ is $ I^\mm / P^\mm $, where $ I^\mm $ is all the non-zero fractional ideals prime to $ \mm $ and $ P^\mm $ is all the ideals generated by $ a \equiv 1 \mod \mm $.

\begin{theorem}
There exists a \textbf{ray class field} $ L / K $.
\end{theorem}

Can understand $ Gal\rb{\overline{K} / K}^{ab} $. Let
$$ Gal\rb{\overline{K} / K} = \varprojlim_{L / K \ \text{finite}} Gal\rb{L / K} $$
be the \textbf{absolute Galois group} of $ K $. Can describe $ Gal\rb{\overline{K} / K}^{ab} $, the maximal abelian quotient of $ Gal\rb{\overline{K} / K} $, in terms of generalisations of $ Cl\rb{K} $, the \textbf{idele class group} $ I_K $.

\begin{theorem}[Global Artin reciprocity]
$ I_K / Nm_{L / K}\rb{I_L} \cong Gal\rb{\overline{K} / K}^{ab} $.
\end{theorem}

This is interesting for $ K = \Q $.

\subsection{Modular forms and elliptic curves}

If $ Gal\rb{L / K} $ is not abelian, need to understand $ n $-dimensional representations of $ Gal\rb{L / K} $.

\begin{example*}
$ Gal\rb{L / K} \cong S_3 $ has $ 2 $-dimensional irreducible representations $ \rho : S_3 \to GL_2\rb{\C} $, so
$$ Gal\rb{\overline{K} / K} \twoheadrightarrow Gal\rb{L / K} \cong S_3 \xrightarrow{\rho} GL_2\rb{\C}. $$
\end{example*}

The $ n = 2 $ case is related to \textbf{modular forms}, holomorphic functions $ f $ on $ \HH = \cb{z \in \C \mid \Im\rb{z} > 0} $ satisfying certain symmetries. $ SL_2\rb{\Z} $ acts on $ \HH $ by
$$ \function{SL_2\rb{\Z} \curvearrowright \HH}{\HH}{\twobytwo{a}{b}{c}{d}\rb{z}}{\dfrac{az + b}{cz + d}}, $$
where $ a, b, c, d \in \Z $ and $ ad - bc = 1 $, so
$$ \twobytwo{1}{0}{0}{1} : z \mapsto z, \qquad \twobytwo{1}{1}{0}{1} : z \mapsto z + 1, \qquad \twobytwo{0}{1}{-1}{0} : z \mapsto -\dfrac{1}{z}. $$
Expanding $ f\rb{z} = f\rb{z + 1} $ in Fourier series,
$$ f\rb{z} = q + a_2q^2 + a_3q^3 + \dots, \qquad q = e^{2\pi iz}. $$

\begin{example*}
$ f\rb{z} = q\prod_{n = 1}^\infty \rb{1 - q^n}^2\rb{1 - q^{11n}}^2 $ is a modular form.
\end{example*}

On the other hand, \textbf{elliptic curves}, smooth projective curves $ E / \Q $ of genus one, have a \textbf{group law} over $ \Q $. Let $ E\sb{p} $ be the \textbf{$ p $-torsion points}, where
$$ 0 = \sb{p}\rb{x_0, y_0} = \rb{x_0, y_0} +_E \dots +_E \rb{x_0, y_0}. $$
Then $ Gal\rb{\overline{\Q} / \Q} $ acts on $ E\sb{p} $ to give $ \rb{x_0, y_0} $ for algebraic numbers $ x_0, y_0 \in \overline{\Q} $, and $ E\sb{p^n} \cong \rb{\Z / p^n\Z}^2 $.

\begin{example*}
$ y^2 + y = x^3 - x^2 $ is an elliptic curve.
\end{example*}

\subsection{From Artin reciprocity to modularity}

If $ L $ be the Hilbert class field of $ K $, then a one-dimensional reciprocity is
$$ Gal\rb{L / K} \cong Cl\rb{K}. $$
If $ E $ is an elliptic curve and $ a_p $ is the Fourier coefficient to a modular form for some prime $ p $, a two-dimensional reciprocity is
$$ p - \#\cb{\text{solutions to} \ E \mod p} = a_p. $$
This was the key to the proof of Fermat's last theorem.

\end{document}
